<html><head><title>Kernel::System::Stats</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.28,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018004 at Tue Feb 16 20:51:24 2021 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Explanation_for_the_time_zone_parameter'>Explanation for the time zone parameter</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#PUBLIC_INTERFACE'>PUBLIC INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new()'>new()</a>
    <li class='indexItem indexItem2'><a href='#StatsAdd()'>StatsAdd()</a>
    <li class='indexItem indexItem2'><a href='#StatsGet()'>StatsGet()</a>
    <li class='indexItem indexItem2'><a href='#StatsUpdate()'>StatsUpdate()</a>
    <li class='indexItem indexItem2'><a href='#StatsDelete()'>StatsDelete()</a>
    <li class='indexItem indexItem2'><a href='#StatsListGet()'>StatsListGet()</a>
    <li class='indexItem indexItem2'><a href='#GetStatsList()'>GetStatsList()</a>
    <li class='indexItem indexItem2'><a href='#SumBuild()'>SumBuild()</a>
    <li class='indexItem indexItem2'><a href='#GetStatsObjectAttributes()'>GetStatsObjectAttributes()</a>
    <li class='indexItem indexItem2'><a href='#GetStaticFiles()'>GetStaticFiles()</a>
    <li class='indexItem indexItem2'><a href='#GetDynamicFiles()'>GetDynamicFiles()</a>
    <li class='indexItem indexItem2'><a href='#GetObjectName()'>GetObjectName()</a>
    <li class='indexItem indexItem2'><a href='#GetObjectBehaviours()'>GetObjectBehaviours()</a>
    <li class='indexItem indexItem2'><a href='#ObjectFileCheck()'>ObjectFileCheck()</a>
    <li class='indexItem indexItem2'><a href='#ObjectModuleCheck()'>ObjectModuleCheck()</a>
    <li class='indexItem indexItem2'><a href='#Export()'>Export()</a>
    <li class='indexItem indexItem2'><a href='#Import()'>Import()</a>
    <li class='indexItem indexItem2'><a href='#GetParams()'>GetParams()</a>
    <li class='indexItem indexItem2'><a href='#StatsRun()'>StatsRun()</a>
    <li class='indexItem indexItem2'><a href='#StatsResultCacheCompute()'>StatsResultCacheCompute()</a>
    <li class='indexItem indexItem2'><a href='#StatsResultCacheGet()'>StatsResultCacheGet()</a>
    <li class='indexItem indexItem2'><a href='#StringAndTimestamp2Filename()'>StringAndTimestamp2Filename()</a>
    <li class='indexItem indexItem2'><a href='#StatNumber2StatID()'>StatNumber2StatID()</a>
    <li class='indexItem indexItem2'><a href='#StatsInstall()'>StatsInstall()</a>
    <li class='indexItem indexItem2'><a href='#StatsUninstall()'>StatsUninstall()</a>
    <li class='indexItem indexItem2'><a href='#StatsCleanUp()'>StatsCleanUp()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#TERMS_AND_CONDITIONS'>TERMS AND CONDITIONS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
><a name='//apple_ref/cpp/Class/NAME' class='dashAnchor'></a>NAME</a></h1>

<p>Kernel::System::Stats - stats lib</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
><a name='//apple_ref/cpp/Class/DESCRIPTION' class='dashAnchor'></a>DESCRIPTION</a></h1>

<p>All stats functions.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Explanation_for_the_time_zone_parameter"
><a name='//apple_ref/cpp/Function/Explanation for the time zone parameter' class='dashAnchor'></a>Explanation for the time zone parameter</a></h2>

<p>The time zone parameter is available,
if the statistic is a dynamic statistic.
The selected periods in the frontend are time zone neutral and for the search parameters,
the selection will be converted to the OTRS time zone,
because the times are stored within this time zone in the database.</p>

<p>This means e.g.
if an absolute period of time from 2015-08-01 00:00:00 to 2015-09-10 23:59:59 and a time zone with an offset of +6 hours has been selected,
the period will be converted from the +6 time zone to the OTRS time zone for the search parameter,
so that the right time will be used for searching the database.
Given that the OTRS time zone is set to UTC,
this would result in a period of 2015-07-31 18:00:00 to 2015-09-10 17:59:59 UTC.</p>

<p>For a relative time period,
e.
g.
the last 10 full days,
and a time zone with an offset of +10 hours,
a DateTime object with the +10 time zone will be created for the current time.
For the period end date,
this date will be taken and extended to the end of the day.
Then,
10 full days will be subtracted from this.
This is the start of the period,
which will be extended to 00:00:00.
Start and end date will be converted to the time zone of OTRS to search the database.</p>

<p>Example for relative time period &#39;last 10 full days&#39; with selected time zone offset +10 hours,
current date/time within this time zone 2015-09-10 16:00:00,
OTRS time zone is UTC: End date: 2015-09-10 16:00:00 -&#62; extended to 2015-09-10 23:59:59 -&#62; 2015-09-10 13:59:59 OTRS time zone (UTC) Start date: 2015-09-10 16:00:00 - 10 days -&#62; 2015-08-31 16:00:00 -&#62; extended to 00:00:00: 2015-09-01 00:00:00 -&#62; 2015-08-31 14:00:00 OTRS time zone (UTC)</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PUBLIC_INTERFACE"
><a name='//apple_ref/cpp/Class/PUBLIC INTERFACE' class='dashAnchor'></a>PUBLIC INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new()"
><a name='//apple_ref/cpp/Function/new()' class='dashAnchor'></a>new()</a></h2>

<p>Don&#39;t use the constructor directly,
use the ObjectManager instead:</p>

<pre>    my $StatsObject = $Kernel::OM-&#62;Get(&#39;Kernel::System::Stats&#39;);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsAdd()"
><a name='//apple_ref/cpp/Function/StatsAdd()' class='dashAnchor'></a>StatsAdd()</a></h2>

<p>add new empty stats</p>

<pre>    my $StatID = $StatsObject-&#62;StatsAdd(
        UserID =&#62; $UserID,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsGet()"
><a name='//apple_ref/cpp/Function/StatsGet()' class='dashAnchor'></a>StatsGet()</a></h2>

<p>get a hash ref of the stats you need</p>

<pre>    my $HashRef = $StatsObject-&#62;StatsGet(
        StatID             =&#62; &#39;123&#39;,
        NoObjectAttributes =&#62; 1,       # optional
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsUpdate()"
><a name='//apple_ref/cpp/Function/StatsUpdate()' class='dashAnchor'></a>StatsUpdate()</a></h2>

<p>update a stat</p>

<pre>    $StatsObject-&#62;StatsUpdate(
        StatID =&#62; &#39;123&#39;,
        Hash   =&#62; \%Hash,
        UserID =&#62; $UserID,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsDelete()"
><a name='//apple_ref/cpp/Function/StatsDelete()' class='dashAnchor'></a>StatsDelete()</a></h2>

<p>delete a stats</p>

<pre>    $StatsObject-&#62;StatsDelete( StatID =&#62; &#39;123&#39; );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsListGet()"
><a name='//apple_ref/cpp/Function/StatsListGet()' class='dashAnchor'></a>StatsListGet()</a></h2>

<p>fetches all statistics that the current user may see</p>

<pre>    my $StatsRef = $StatsObject-&#62;StatsListGet(
        AccessRw =&#62; 1, # Optional, indicates that user may see all statistics
        UserID   =&#62; $UserID,
    );

    Returns

    {
        6 =&#62; {
            Title =&#62; &#34;Title of stat&#34;,
            ...
        }
    }</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetStatsList()"
><a name='//apple_ref/cpp/Function/GetStatsList()' class='dashAnchor'></a>GetStatsList()</a></h2>

<p>lists all stats id&#39;s</p>

<pre>    my $ArrayRef = $StatsObject-&#62;GetStatsList(
        AccessRw  =&#62; 1, # Optional, indicates that user may see all statistics
        OrderBy   =&#62; &#39;ID&#39; || &#39;Title&#39; || &#39;Object&#39;, # optional
        Direction =&#62; &#39;ASC&#39; || &#39;DESC&#39;,             # optional
        UserID    =&#62; $UserID,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="SumBuild()"
><a name='//apple_ref/cpp/Function/SumBuild()' class='dashAnchor'></a>SumBuild()</a></h2>

<p>build sum in x or/and y axis</p>

<pre>    $StatArray = $StatsObject-&#62;SumBuild(
        Array  =&#62; \@Result,
        SumRow =&#62; 1,
        SumCol =&#62; 0,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetStatsObjectAttributes()"
><a name='//apple_ref/cpp/Function/GetStatsObjectAttributes()' class='dashAnchor'></a>GetStatsObjectAttributes()</a></h2>

<p>Get all attributes from the object in dependence of the use</p>

<pre>    my %ObjectAttributes = $StatsObject-&#62;GetStatsObjectAttributes(
        ObjectModule =&#62; &#39;Ticket&#39;,
        Use          =&#62; &#39;UseAsXvalue&#39; || &#39;UseAsValueSeries&#39; || &#39;UseAsRestriction&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetStaticFiles()"
><a name='//apple_ref/cpp/Function/GetStaticFiles()' class='dashAnchor'></a>GetStaticFiles()</a></h2>

<p>Get all static files</p>

<pre>    my $FileHash = $StatsObject-&#62;GetStaticFiles(
        OnlyUnusedFiles =&#62; 1 | 0, # optional default 0
        UserID =&#62; $UserID,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetDynamicFiles()"
><a name='//apple_ref/cpp/Function/GetDynamicFiles()' class='dashAnchor'></a>GetDynamicFiles()</a></h2>

<p>Get all static objects</p>

<pre>    my $FileHash = $StatsObject-&#62;GetDynamicFiles();</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetObjectName()"
><a name='//apple_ref/cpp/Function/GetObjectName()' class='dashAnchor'></a>GetObjectName()</a></h2>

<p>Get the name of a dynamic object</p>

<pre>    my $ObjectName = $StatsObject-&#62;GetObjectName(
        ObjectModule =&#62; &#39;Kernel::System::Stats::Dynamic::TicketList&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetObjectBehaviours()"
><a name='//apple_ref/cpp/Function/GetObjectBehaviours()' class='dashAnchor'></a>GetObjectBehaviours()</a></h2>

<p>get behaviours that a statistic supports</p>

<pre>    my $Behaviours = $StatsObject-&#62;GetObjectBehaviours(
        ObjectModule =&#62; &#39;Kernel::System::Stats::Dynamic::TicketList&#39;,
    );

    returns

    {
        ProvidesDashboardWidget =&#62; 1,
        ...
    }</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ObjectFileCheck()"
><a name='//apple_ref/cpp/Function/ObjectFileCheck()' class='dashAnchor'></a>ObjectFileCheck()</a></h2>

<p>AT THE MOMENT NOT USED</p>

<p>check readable object file</p>

<pre>    my $ObjectFileCheck = $StatsObject-&#62;ObjectFileCheck(
        Type =&#62; &#39;static&#39;,
        Name =&#62; &#39;NewTickets&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ObjectModuleCheck()"
><a name='//apple_ref/cpp/Function/ObjectModuleCheck()' class='dashAnchor'></a>ObjectModuleCheck()</a></h2>

<p>Check the object module.</p>

<pre>    my $ObjectModuleCheck = $StatsObject-&#62;ObjectModuleCheck(
        StatType                     =&#62; &#39;static&#39;,
        ObjectModule                 =&#62; &#39;Kernel::System::Stats::Static::StateAction&#39;,
        CheckAlreadyUsedStaticObject =&#62; 1,                                             # optional
    );</pre>

<p>Returns true on success and false on error.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Export()"
><a name='//apple_ref/cpp/Function/Export()' class='dashAnchor'></a>Export()</a></h2>

<p>get content from stats for export</p>

<pre>    my $ExportFile = $StatsObject-&#62;Export(
        StatID =&#62; &#39;123&#39;,
        ExportStatNumber =&#62; 1 || 0, # optional, only useful move statistics from the test system to the productive system
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Import()"
><a name='//apple_ref/cpp/Function/Import()' class='dashAnchor'></a>Import()</a></h2>

<p>import a stats from xml file</p>

<pre>    my $StatID = $StatsObject-&#62;Import(
        UserID  =&#62; $UserID,
        Content =&#62; $UploadStuff{Content},
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="GetParams()"
><a name='//apple_ref/cpp/Function/GetParams()' class='dashAnchor'></a>GetParams()</a></h2>

<pre>    get all edit params from stats for view

    my $Params = $StatsObject-&#62;GetParams( StatID =&#62; &#39;123&#39; );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsRun()"
><a name='//apple_ref/cpp/Function/StatsRun()' class='dashAnchor'></a>StatsRun()</a></h2>

<p>run a statistic.</p>

<pre>    my $StatArray = $StatsObject-&#62;StatsRun(
        StatID     =&#62; &#39;123&#39;,
        GetParam   =&#62; \%GetParam,
        Preview    =&#62; 1,        # optional, return fake data for preview (only for dynamic stats)
        UserID     =&#62; $UserID,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsResultCacheCompute()"
><a name='//apple_ref/cpp/Function/StatsResultCacheCompute()' class='dashAnchor'></a>StatsResultCacheCompute()</a></h2>

<p>computes stats results and adds them to the cache. This can be used to precompute stats data e. g. for dashboard widgets in a cron job.</p>

<pre>    my $StatArray = $StatsObject-&#62;StatsResultCacheCompute(
        StatID       =&#62; &#39;123&#39;,
        UserID       =&#62; $UserID,        # target UserID
        UserGetParam =&#62; \%UserGetParam, # user settings of non-fixed fields
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsResultCacheGet()"
><a name='//apple_ref/cpp/Function/StatsResultCacheGet()' class='dashAnchor'></a>StatsResultCacheGet()</a></h2>

<p>gets cached statistic results. Will never run the statistic. This can be used to fetch cached stats data e. g. for stats widgets in the dashboard.</p>

<pre>    my $StatArray = $StatsObject-&#62;StatsResultCacheGet(
        StatID       =&#62; &#39;123&#39;,
        UserID       =&#62; $UserID,    # target UserID
        UserGetParam =&#62; \%GetParam,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StringAndTimestamp2Filename()"
><a name='//apple_ref/cpp/Function/StringAndTimestamp2Filename()' class='dashAnchor'></a>StringAndTimestamp2Filename()</a></h2>

<p>builds a filename with a string and a timestamp. (space will be replaced with _ and - e.g. Title-of-File_2006-12-31_11-59)</p>

<pre>    my $Filename = $StatsObject-&#62;StringAndTimestamp2Filename(
        String   =&#62; &#39;Title&#39;,
        TimeZone =&#62; &#39;Europe/Berlin&#39;,  # optional
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatNumber2StatID()"
><a name='//apple_ref/cpp/Function/StatNumber2StatID()' class='dashAnchor'></a>StatNumber2StatID()</a></h2>

<p>insert the stat number get the stat id</p>

<pre>    my $StatID = $StatsObject-&#62;StatNumber2StatID(
        StatNumber =&#62; 11212,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsInstall()"
><a name='//apple_ref/cpp/Function/StatsInstall()' class='dashAnchor'></a>StatsInstall()</a></h2>

<p>installs stats</p>

<pre>    my $Result = $StatsObject-&#62;StatsInstall(
        FilePrefix =&#62; &#39;FAQ&#39;,  # (optional)
        UserID     =&#62; $UserID,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsUninstall()"
><a name='//apple_ref/cpp/Function/StatsUninstall()' class='dashAnchor'></a>StatsUninstall()</a></h2>

<p>uninstalls stats</p>

<pre>    my $Result = $StatsObject-&#62;StatsUninstall(
        FilePrefix =&#62; &#39;FAQ&#39;,  # (optional)
        UserID     =&#62; $UserID,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="StatsCleanUp()"
><a name='//apple_ref/cpp/Function/StatsCleanUp()' class='dashAnchor'></a>StatsCleanUp()</a></h2>

<p>removed stats with not existing backend file</p>

<pre>    my $Result = $StatsObject-&#62;StatsCleanUp(
        UserID =&#62; 1,

        ObjectNames =&#62; [ &#39;Ticket&#39;, &#39;TicketList&#39; ],
        or
        CheckAllObjects =&#62; 1,
    );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TERMS_AND_CONDITIONS"
><a name='//apple_ref/cpp/Class/TERMS AND CONDITIONS' class='dashAnchor'></a>TERMS AND CONDITIONS</a></h1>

<p>This software is part of the OTRS project (<a href="https://otrs.org/" class="podlinkurl"
>https://otrs.org/</a>).</p>

<p>This software comes with ABSOLUTELY NO WARRANTY. For details, see the enclosed file COPYING for license information (GPL). If you did not receive this file, see <a href="https://www.gnu.org/licenses/gpl-3.0.txt" class="podlinkurl"
>https://www.gnu.org/licenses/gpl-3.0.txt</a>.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
