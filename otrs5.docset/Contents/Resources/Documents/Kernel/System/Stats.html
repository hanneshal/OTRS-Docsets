<html><head><title>Kernel::System::Stats</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.28,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018002 at Sat Oct 10 15:09:26 2015 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#SYNOPSIS'>SYNOPSIS</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#Explanation_for_the_time_zone_parameter'>Explanation for the time zone parameter</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#PUBLIC_INTERFACE'>PUBLIC INTERFACE</a>
  <li class='indexItem indexItem1'><a href='#TERMS_AND_CONDITIONS'>TERMS AND CONDITIONS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Kernel::System::Stats - stats lib</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="SYNOPSIS"
>SYNOPSIS</a></h1>

<p>All stats functions.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Explanation_for_the_time_zone_parameter"
>Explanation for the time zone parameter</a></h2>

<p>The time zone parameter is available,
if the system use UTC as system time and the TimeZoneUser feature is active and the statistic is a dynamic statistic.
The selected periods in the frontend are time zone neutral and for the search parameters,
the selection will be converted to UTC time based on the selected time zone,
because the times are stored as UTC time in the database (if the system is configured correctly).</p>

<p>This means e.g.
if a absolute period of time from 2015 2015-08-01 00:00:00 to 2015-09-10 23:59:59 and a time zone +6 has been selected,
the time zone (+6) will be subtracted (with &#34;_SubtractTimeZone&#34;) from the selected absolute time period for the search parameter,
so that the right UTC time will be used for the absolute period of time.
For the example this would be the 2015-07-31 18:00:00 to 2015-09-10 17:59:59.</p>

<p>For a relative time period,
e.g.
a relative period of the last full 10 days and the time zone +10,
first the selected time zone will be added (with &#34;_AddTimeZone&#34;) to the current UTC time,
so that the right relative period of time will be used for the frontend output.
For the example,
we have the current UTC time 2015-09-10 16:00:00,
that means for the selected relative period and time zone (+10) the period of time from 2015-09-01 00:00:00 to 2015-09-10 23:59:59.
From the period of time will be substracted the selected time zone (+10) to get the correct UTC time for the search in the database (as for the absolute time).
In this case that would be the period of time from 2015-08-31 14:00:00 to 2015-09-10 13:59:59.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PUBLIC_INTERFACE"
>PUBLIC INTERFACE</a></h1>

<dl>
<dt><a name="new()"
>new()</a></dt>

<dd>
<p>create an object.
Do not use it directly,
instead use:</p>

<pre>    use Kernel::System::ObjectManager;
    local $Kernel::OM = Kernel::System::ObjectManager-&#62;new();
    my $StatsObject = $Kernel::OM-&#62;Get(&#39;Kernel::System::Stats&#39;);</pre>

<dt><a name="StatsAdd()"
>StatsAdd()</a></dt>

<dd>
<p>add new empty stats</p>

<pre>    my $StatID = $StatsObject-&#62;StatsAdd(
        UserID =&#62; $UserID,
    );</pre>

<dt><a name="StatsGet()"
>StatsGet()</a></dt>

<dd>
<p>get a hash ref of the stats you need</p>

<pre>    my $HashRef = $StatsObject-&#62;StatsGet(
        StatID             =&#62; &#39;123&#39;,
        NoObjectAttributes =&#62; 1,       # optional
    );</pre>

<dt><a name="StatsUpdate()"
>StatsUpdate()</a></dt>

<dd>
<p>update a stat</p>

<pre>    $StatsObject-&#62;StatsUpdate(
        StatID =&#62; &#39;123&#39;,
        Hash   =&#62; \%Hash,
        UserID =&#62; $UserID,
    );</pre>

<dt><a name="StatsDelete()"
>StatsDelete()</a></dt>

<dd>
<p>delete a stats</p>

<pre>    $StatsObject-&#62;StatsDelete( StatID =&#62; &#39;123&#39; );</pre>

<dt><a name="StatsListGet()"
>StatsListGet()</a></dt>

<dd>
<p>fetches all statistics that the current user may see</p>

<pre>    my $StatsRef = $StatsObject-&#62;StatsListGet(
        AccessRw =&#62; 1, # Optional, indicates that user may see all statistics
        UserID   =&#62; $UserID,
    );

    Returns

    {
        6 =&#62; {
            Title =&#62; &#34;Title of stat&#34;,
            ...
        }
    }</pre>

<dt><a name="GetStatsList()"
>GetStatsList()</a></dt>

<dd>
<p>lists all stats id&#39;s</p>

<pre>    my $ArrayRef = $StatsObject-&#62;GetStatsList(
        AccessRw  =&#62; 1, # Optional, indicates that user may see all statistics
        OrderBy   =&#62; &#39;ID&#39; || &#39;Title&#39; || &#39;Object&#39;, # optional
        Direction =&#62; &#39;ASC&#39; || &#39;DESC&#39;,             # optional
        UserID    =&#62; $UserID,
    );</pre>

<dt><a name="SumBuild()"
>SumBuild()</a></dt>

<dd>
<p>build sum in x or/and y axis</p>

<pre>    $StatArray = $StatsObject-&#62;SumBuild(
        Array  =&#62; \@Result,
        SumRow =&#62; 1,
        SumCol =&#62; 0,
    );</pre>

<dt><a name="GetStatsObjectAttributes()"
>GetStatsObjectAttributes()</a></dt>

<dd>
<p>Get all attributes from the object in dependence of the use</p>

<pre>    my %ObjectAttributes = $StatsObject-&#62;GetStatsObjectAttributes(
        ObjectModule =&#62; &#39;Ticket&#39;,
        Use          =&#62; &#39;UseAsXvalue&#39; || &#39;UseAsValueSeries&#39; || &#39;UseAsRestriction&#39;,
    );</pre>

<dt><a name="GetStaticFiles()"
>GetStaticFiles()</a></dt>

<dd>
<p>Get all static files</p>

<pre>    my $FileHash = $StatsObject-&#62;GetStaticFiles(
        OnlyUnusedFiles =&#62; 1 | 0, # optional default 0
        UserID =&#62; $UserID,
    );</pre>

<dt><a name="GetDynamicFiles()"
>GetDynamicFiles()</a></dt>

<dd>
<p>Get all static objects</p>

<pre>    my $FileHash = $StatsObject-&#62;GetDynamicFiles();</pre>

<dt><a name="GetObjectName()"
>GetObjectName()</a></dt>

<dd>
<p>Get the name of a dynamic object</p>

<pre>    my $ObjectName = $StatsObject-&#62;GetObjectName(
        ObjectModule =&#62; &#39;Kernel::System::Stats::Dynamic::TicketList&#39;,
    );</pre>

<dt><a name="GetObjectBehaviours()"
>GetObjectBehaviours()</a></dt>

<dd>
<p>get behaviours that a statistic supports</p>

<pre>    my $Behaviours = $StatsObject-&#62;GetObjectBehaviours(
        ObjectModule =&#62; &#39;Kernel::System::Stats::Dynamic::TicketList&#39;,
    );

    returns

    {
        ProvidesDashboardWidget =&#62; 1,
        ...
    }</pre>

<dt><a name="ObjectFileCheck()"
>ObjectFileCheck()</a></dt>

<dd>
<p>check readable object file</p>

<pre>    my $ObjectFileCheck = $StatsObject-&#62;ObjectFileCheck(
        Type =&#62; &#39;static&#39;,
        Name =&#62; &#39;NewTickets&#39;,
    );</pre>

<dt><a name="Export()"
>Export()</a></dt>

<dd>
<p>get content from stats for export</p>

<pre>    my $ExportFile = $StatsObject-&#62;Export(
        StatID =&#62; &#39;123&#39;,
        ExportStatNumber =&#62; 1 || 0, # optional, only useful move statistics from the test system to the productive system
    );</pre>

<dt><a name="Import()"
>Import()</a></dt>

<dd>
<p>import a stats from xml file</p>

<pre>    my $StatID = $StatsObject-&#62;Import(
        UserID  =&#62; $UserID,
        Content =&#62; $UploadStuff{Content},
    );</pre>

<dt><a name="GetParams()"
>GetParams()</a></dt>

<dd>
<pre>    get all edit params from stats for view

    my $Params = $StatsObject-&#62;GetParams( StatID =&#62; &#39;123&#39; );</pre>

<dt><a name="StatsRun()"
>StatsRun()</a></dt>

<dd>
<p>run a statistic.</p>

<pre>    my $StatArray = $StatsObject-&#62;StatsRun(
        StatID     =&#62; &#39;123&#39;,
        GetParam   =&#62; \%GetParam,
        Preview    =&#62; 1,        # optional, return fake data for preview (only for dynamic stats)
        UserID     =&#62; $UserID,
    );</pre>

<dt><a name="StatsResultCacheCompute()"
>StatsResultCacheCompute()</a></dt>

<dd>
<p>computes stats results and adds them to the cache. This can be used to precompute stats data e. g. for dashboard widgets in a cron job.</p>

<pre>    my $StatArray = $StatsObject-&#62;StatsResultCacheCompute(
        StatID       =&#62; &#39;123&#39;,
        UserID       =&#62; $UserID,        # target UserID
        UserGetParam =&#62; \%UserGetParam, # user settings of non-fixed fields
    );</pre>

<dt><a name="StatsResultCacheGet()"
>StatsResultCacheGet()</a></dt>

<dd>
<p>gets cached statistic results. Will never run the statistic. This can be used to fetch cached stats data e. g. for stats widgets in the dashboard.</p>

<pre>    my $StatArray = $StatsObject-&#62;StatsResultCacheGet(
        StatID       =&#62; &#39;123&#39;,
        UserID       =&#62; $UserID,    # target UserID
        UserGetParam =&#62; \%GetParam,
    );</pre>

<dt><a name="StringAndTimestamp2Filename()"
>StringAndTimestamp2Filename()</a></dt>

<dd>
<p>builds a filename with a string and a timestamp. (space will be replaced with _ and - e.g. Title-of-File_2006-12-31_11-59)</p>

<pre>    my $Filename = $StatsObject-&#62;StringAndTimestamp2Filename(
        String   =&#62; &#39;Title&#39;,
        TimeZone =&#62; &#39;+2&#39;,  # optional
    );</pre>

<dt><a name="StatNumber2StatID()"
>StatNumber2StatID()</a></dt>

<dd>
<p>insert the stat number get the stat id</p>

<pre>    my $StatID = $StatsObject-&#62;StatNumber2StatID(
        StatNumber =&#62; 11212,
    );</pre>

<dt><a name="StatsInstall()"
>StatsInstall()</a></dt>

<dd>
<p>installs stats</p>

<pre>    my $Result = $StatsObject-&#62;StatsInstall(
        FilePrefix =&#62; &#39;FAQ&#39;,  # (optional)
        UserID     =&#62; $UserID,
    );</pre>

<dt><a name="StatsUninstall()"
>StatsUninstall()</a></dt>

<dd>
<p>uninstalls stats</p>

<pre>    my $Result = $StatsObject-&#62;StatsUninstall(
        FilePrefix =&#62; &#39;FAQ&#39;,  # (optional)
        UserID     =&#62; $UserID,
    );</pre>

<dt><a name="StatsCleanUp()"
>StatsCleanUp()</a></dt>

<dd>
<p>removed stats with not existing backend file</p>

<pre>    my $Result = $StatsObject-&#62;StatsCleanUp();</pre>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TERMS_AND_CONDITIONS"
>TERMS AND CONDITIONS</a></h1>

<p>This software is part of the OTRS project (<a href="http://otrs.org/" class="podlinkurl"
>http://otrs.org/</a>).</p>

<p>This software comes with ABSOLUTELY NO WARRANTY. For details, see the enclosed file COPYING for license information (AGPL). If you did not receive this file, see <a href="http://www.gnu.org/licenses/agpl.txt" class="podlinkurl"
>http://www.gnu.org/licenses/agpl.txt</a>.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
