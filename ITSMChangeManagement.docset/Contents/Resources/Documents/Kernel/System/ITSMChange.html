<html><head><title>Kernel::System::ITSMChange</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.28,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018004 at Tue Feb 16 20:51:27 2021 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#PUBLIC_INTERFACE'>PUBLIC INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new()'>new()</a>
    <li class='indexItem indexItem2'><a href='#ChangeAdd()'>ChangeAdd()</a>
    <li class='indexItem indexItem2'><a href='#ChangeUpdate()'>ChangeUpdate()</a>
    <li class='indexItem indexItem2'><a href='#ChangeGet()'>ChangeGet()</a>
    <li class='indexItem indexItem2'><a href='#ChangeCABUpdate()'>ChangeCABUpdate()</a>
    <li class='indexItem indexItem2'><a href='#ChangeCABGet()'>ChangeCABGet()</a>
    <li class='indexItem indexItem2'><a href='#ChangeCABDelete()'>ChangeCABDelete()</a>
    <li class='indexItem indexItem2'><a href='#ChangeLookup()'>ChangeLookup()</a>
    <li class='indexItem indexItem2'><a href='#ChangeList()'>ChangeList()</a>
    <li class='indexItem indexItem2'><a href='#ChangeSearch()'>ChangeSearch()</a>
    <li class='indexItem indexItem2'><a href='#ChangeDelete()'>ChangeDelete()</a>
    <li class='indexItem indexItem2'><a href='#ChangeStateLookup()'>ChangeStateLookup()</a>
    <li class='indexItem indexItem2'><a href='#ChangePossibleStatesGet()'>ChangePossibleStatesGet()</a>
    <li class='indexItem indexItem2'><a href='#ChangePossibleCIPGet()'>ChangePossibleCIPGet()</a>
    <li class='indexItem indexItem2'><a href='#ChangeCIPLookup()'>ChangeCIPLookup()</a>
    <li class='indexItem indexItem2'><a href='#Permission()'>Permission()</a>
    <li class='indexItem indexItem2'><a href='#ChangeAttachmentAdd()'>ChangeAttachmentAdd()</a>
    <li class='indexItem indexItem2'><a href='#ChangeAttachmentDelete()'>ChangeAttachmentDelete()</a>
    <li class='indexItem indexItem2'><a href='#ChangeAttachmentGet()'>ChangeAttachmentGet()</a>
    <li class='indexItem indexItem2'><a href='#ChangeAttachmentList()'>ChangeAttachmentList()</a>
    <li class='indexItem indexItem2'><a href='#ChangeAttachmentExists()'>ChangeAttachmentExists()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#PRIVATE_INTERFACE'>PRIVATE INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#_CheckChangeStateIDs()'>_CheckChangeStateIDs()</a>
    <li class='indexItem indexItem2'><a href='#_CheckChangeCIPIDs()'>_CheckChangeCIPIDs()</a>
    <li class='indexItem indexItem2'><a href='#_CheckChangeParams()'>_CheckChangeParams()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#TERMS_AND_CONDITIONS'>TERMS AND CONDITIONS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
><a name='//apple_ref/cpp/Class/NAME' class='dashAnchor'></a>NAME</a></h1>

<p>Kernel::System::ITSMChange - change lib</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
><a name='//apple_ref/cpp/Class/DESCRIPTION' class='dashAnchor'></a>DESCRIPTION</a></h1>

<p>All functions for changes in ITSMChangeManagement.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PUBLIC_INTERFACE"
><a name='//apple_ref/cpp/Class/PUBLIC INTERFACE' class='dashAnchor'></a>PUBLIC INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new()"
><a name='//apple_ref/cpp/Function/new()' class='dashAnchor'></a>new()</a></h2>

<p>create an object</p>

<pre>    use Kernel::System::ObjectManager;
    local $Kernel::OM = Kernel::System::ObjectManager-&#62;new();
    my $ChangeObject = $Kernel::OM-&#62;Get(&#39;Kernel::System::ITSMChange&#39;);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeAdd()"
><a name='//apple_ref/cpp/Function/ChangeAdd()' class='dashAnchor'></a>ChangeAdd()</a></h2>

<p>Add a new change. The UserID is the only required parameter. Internally first a minimal change is created, then ChangeUpdate() is called.</p>

<pre>    my $ChangeID = $ChangeObject-&#62;ChangeAdd(
        UserID =&#62; 1,
    );</pre>

<p>or</p>

<pre>    my $ChangeID = $ChangeObject-&#62;ChangeAdd(
        ChangeTitle     =&#62; &#39;Replacement of mail server&#39;,       # (optional)
        Description     =&#62; &#39;New mail server is faster&#39;,        # (optional)
        Justification   =&#62; &#39;Old mail server too slow&#39;,         # (optional)
        ChangeStateID   =&#62; 4,                                  # (optional) or ChangeState =&#62; &#39;accepted&#39;
        ChangeState     =&#62; &#39;accepted&#39;,                         # (optional) or ChangeStateID =&#62; 4
        ChangeManagerID =&#62; 5,                                  # (optional)
        ChangeBuilderID =&#62; 6,                                  # (optional)
        CategoryID      =&#62; 7,                                  # (optional) or Category =&#62; &#39;3 normal&#39;
        Category        =&#62; &#39;3 normal&#39;,                         # (optional) or CategoryID =&#62; 4
        ImpactID        =&#62; 8,                                  # (optional) or Impact =&#62; &#39;4 high&#39;
        Impact          =&#62; &#39;4 high&#39;,                           # (optional) or ImpactID =&#62; 5
        PriorityID      =&#62; 9,                                  # (optional) or Priority =&#62; &#39;5 very high&#39;
        Priority        =&#62; &#39;5 very high&#39;,                      # (optional) or PriorityID =&#62; 6
        CABAgents       =&#62; [ 1, 2, 4 ],     # UserIDs          # (optional)
        CABCustomers    =&#62; [ &#39;tt&#39;, &#39;mm&#39; ],  # CustomerUserIDs  # (optional)
        RequestedTime   =&#62; &#39;2006-01-19 23:59:59&#39;,              # (optional)
        DynamicField_X  =&#62; &#39;Sun&#39;,                              # (optional)
        DynamicField_Y  =&#62; &#39;Earth&#39;,                            # (optional)
        UserID          =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeUpdate()"
><a name='//apple_ref/cpp/Function/ChangeUpdate()' class='dashAnchor'></a>ChangeUpdate()</a></h2>

<p>Update a change. Leading and trailing whitespace is removed from <code>ChangeTitle</code>. Passing undefined values is generally not allowed. An exception is the parameter <code>RequestedTime</code>, where the undefined value indicates that requested time of the change should be cleared.</p>

<pre>    my $Success = $ChangeObject-&#62;ChangeUpdate(
        ChangeID           =&#62; 123,
        ChangeTitle        =&#62; &#39;Replacement of slow mail server&#39;,  # (optional)
        Description        =&#62; &#39;New mail server is faster&#39;,        # (optional)
        Justification      =&#62; &#39;Old mail server too slow&#39;,         # (optional)
        ChangeStateID      =&#62; 4,                                  # (optional) or ChangeState =&#62; &#39;accepted&#39;
        ChangeState        =&#62; &#39;accepted&#39;,                         # (optional) or ChangeStateID =&#62; 4
        ChangeManagerID    =&#62; 5,                                  # (optional)
        ChangeBuilderID    =&#62; 6,                                  # (optional)
        CategoryID         =&#62; 7,                                  # (optional) or Category =&#62; &#39;3 normal&#39;
        Category           =&#62; &#39;3 normal&#39;,                         # (optional) or CategoryID =&#62; 4
        ImpactID           =&#62; 8,                                  # (optional) or Impact =&#62; &#39;4 high&#39;
        Impact             =&#62; &#39;4 high&#39;,                           # (optional) or ImpactID =&#62; 5
        PriorityID         =&#62; 9,                                  # (optional) or Priority =&#62; &#39;5 very high&#39;
        Priority           =&#62; &#39;5 very high&#39;,                      # (optional) or PriorityID =&#62; 6
        CABAgents          =&#62; [ 1, 2, 4 ],                        # (optional) UserIDs
        CABCustomers       =&#62; [ &#39;tt&#39;, &#39;mm&#39; ],                     # (optional) CustomerUserIDs
        RequestedTime      =&#62; &#39;2006-01-19 23:59:59&#39;,              # (optional) or &#39;undef&#39;, which clears the time
        DynamicField_X     =&#62; &#39;Sun&#39;,                              # (optional)
        DynamicField_Y     =&#62; &#39;Earth&#39;,                            # (optional)
        BypassStateMachine =&#62; 1,                                  # (optional) default 0, if 1 the state machine will be bypassed
        UserID             =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeGet()"
><a name='//apple_ref/cpp/Function/ChangeGet()' class='dashAnchor'></a>ChangeGet()</a></h2>

<p>Return a change as a hash reference. When the <code>workorder</code> does not exist, a false value is returned. The optional option <code>LogNo</code> turns off logging when the change does not exist.</p>

<pre>    my $Change = $ChangeObject-&#62;ChangeGet(
        ChangeID =&#62; 123,
        UserID   =&#62; 1,
        LogNo    =&#62; 1,      # optional, turns off logging when the change does not exist
    );</pre>

<p>The returned hash reference contains the following elements:</p>

<pre>    $Change{ChangeID}
    $Change{ChangeNumber}
    $Change{ChangeStateID}
    $Change{ChangeState}            # fetched from the general catalog
    $Change{ChangeStateSignal}      # fetched from SysConfig
    $Change{ChangeTitle}
    $Change{Description}
    $Change{DescriptionPlain}
    $Change{Justification}
    $Change{JustificationPlain}
    $Change{ChangeManagerID}
    $Change{ChangeBuilderID}
    $Change{CategoryID}
    $Change{Category}
    $Change{ImpactID}
    $Change{Impact}
    $Change{PriorityID}
    $Change{Priority}
    $Change{WorkOrderIDs}           # array reference with WorkOrderIDs, sorted by WorkOrderNumber
    $Change{WorkOrderCount}         # number of workorders
    $Change{CABAgents}              # array reference with CAB Agent UserIDs
    $Change{CABCustomers}           # array reference with CAB CustomerUserIDs
    $Change{PlannedStartTime}       # determined from the workorders
    $Change{PlannedEndTime}         # determined from the workorders
    $Change{ActualStartTime}        # determined from the workorders
    $Change{ActualEndTime}          # determined from the workorders
    $Change{PlannedEffort}          # determined from the workorders
    $Change{AccountedTime}          # determined from the workorders
    $Change{RequestedTime}
    $Change{DynamicField_X}
    $Change{DynamicField_Y}
    $Change{CreateTime}
    $Change{CreateBy}
    $Change{ChangeTime}
    $Change{ChangeBy}</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeCABUpdate()"
><a name='//apple_ref/cpp/Function/ChangeCABUpdate()' class='dashAnchor'></a>ChangeCABUpdate()</a></h2>

<p>Add or update the CAB of a change. One or both of CABAgents and CABCustomers must be passed. Passing a reference to an empty array deletes the part of the CAB (CABAgents or CABCustomers) When agents or customers are passed multiple times, they will be inserted only once.</p>

<pre>    my $Success = $ChangeObject-&#62;ChangeCABUpdate(
        ChangeID     =&#62; 123,
        CABAgents    =&#62; [ 1, 2, 4 ],     # UserIDs          (optional)
        CABCustomers =&#62; [ &#39;tt&#39;, &#39;mm&#39; ],  # CustomerUserIDs  (optional)
        UserID       =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeCABGet()"
><a name='//apple_ref/cpp/Function/ChangeCABGet()' class='dashAnchor'></a>ChangeCABGet()</a></h2>

<p>Return the CAB of a change as a hashref, where the values are arrayrefs. The returned array references are sorted.</p>

<pre>    my $ChangeCAB = $ChangeObject-&#62;ChangeCABGet(
        ChangeID =&#62; 123,
        UserID   =&#62; 1,
    );</pre>

<p>Returns:</p>

<pre>    $ChangeCAB = {
        CABAgents    =&#62; [ 1, 2, 4 ],
        CABCustomers =&#62; [ &#39;aa&#39;, &#39;bb&#39; ],
    }</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeCABDelete()"
><a name='//apple_ref/cpp/Function/ChangeCABDelete()' class='dashAnchor'></a>ChangeCABDelete()</a></h2>

<p>Delete the CAB of a change.</p>

<pre>    my $Success = $ChangeObject-&#62;ChangeCABDelete(
        ChangeID =&#62; 123,
        UserID   =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeLookup()"
><a name='//apple_ref/cpp/Function/ChangeLookup()' class='dashAnchor'></a>ChangeLookup()</a></h2>

<p>Return the change id when the change number is passed. Return the change number when the change id is passed. When no change id or change number is found, then the undefined value is returned.</p>

<pre>    my $ChangeID = $ChangeObject-&#62;ChangeLookup(
        ChangeNumber =&#62; &#39;2009091742000465&#39;,
    );

    or

    my $ChangeNumber = $ChangeObject-&#62;ChangeLookup(
        ChangeID =&#62; 42,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeList()"
><a name='//apple_ref/cpp/Function/ChangeList()' class='dashAnchor'></a>ChangeList()</a></h2>

<p>Return a change id list of all changes as an array reference.</p>

<pre>    my $ChangeIDsRef = $ChangeObject-&#62;ChangeList(
        UserID =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeSearch()"
><a name='//apple_ref/cpp/Function/ChangeSearch()' class='dashAnchor'></a>ChangeSearch()</a></h2>

<p>Returns either a list, as an arrayref, or a count of found change ids. The count of results is returned when the parameter <code>Result = &#39;COUNT&#39;</code> is passed.</p>

<p>The search criteria are logically AND connected. When a list is passed as <code>criterium</code>, the individual members are OR connected. When an undef or a reference to an empty array is passed, then the search <code>criterium</code> is ignored.</p>

<pre>    my $ChangeIDsRef = $ChangeObject-&#62;ChangeSearch(
        ChangeNumber       =&#62; &#39;2009100112345778&#39;,                       # (optional)

        ChangeTitle        =&#62; &#39;Replacement of slow mail server&#39;,        # (optional)
        Description        =&#62; &#39;New mail server is faster&#39;,              # (optional)
        Justification      =&#62; &#39;Old mail server too slow&#39;,               # (optional)

        # array parameters are used with logical OR operator
        ChangeStateIDs     =&#62; [ 11, 12, 13 ],                           # (optional)
        ChangeStates       =&#62; [ &#39;requested&#39;, &#39;failed&#39; ],                # (optional)
        ChangeManagerIDs   =&#62; [ 1, 2, 3 ],                              # (optional)
        ChangeBuilderIDs   =&#62; [ 5, 7, 4 ],                              # (optional)
        CreateBy           =&#62; [ 5, 2, 3 ],                              # (optional)
        ChangeBy           =&#62; [ 3, 2, 1 ],                              # (optional)
        WorkOrderAgentIDs  =&#62; [ 6, 2 ],                                 # (optional)
        CABAgents          =&#62; [ 9, 13 ],                                # (optional)
        CABCustomers       =&#62; [ &#39;tt&#39;, &#39;xx&#39; ],                           # (optional)
        Categories         =&#62; [ &#39;1 very low&#39;, &#39;2 low&#39; ],                # (optional)
        CategoryIDs        =&#62; [ 135, 173 ],                             # (optional)
        Impacts            =&#62; [ &#39;1 very low&#39;, &#39;2 low&#39; ],                # (optional)
        ImpactIDs          =&#62; [ 136, 174 ],                             # (optional)
        Priorities         =&#62; [ &#39;1 very low&#39;, &#39;2 low&#39; ],                # (optional)
        PriorityIDs        =&#62; [ 137, 175 ],                             # (optional)

        # DynamicFields (both change and C&#60;workorder&#62; dynamic fields are possible)
        #   At least one operator must be specified. Operators will be connected with AND,
        #       values in an operator with OR.
        #   You can also pass more than one argument to an operator: [&#39;value1&#39;, &#39;value2&#39;]
        DynamicField_FieldNameX =&#62; {
            Equals            =&#62; 123,
            Like              =&#62; &#39;value*&#39;,                # &#34;equals&#34; operator with wildcard support
            GreaterThan       =&#62; &#39;2001-01-01 01:01:01&#39;,
            GreaterThanEquals =&#62; &#39;2001-01-01 01:01:01&#39;,
            SmallerThan       =&#62; &#39;2002-02-02 02:02:02&#39;,
            SmallerThanEquals =&#62; &#39;2002-02-02 02:02:02&#39;,
        }

        # search in text fields of C&#60;workorder&#62; object
        WorkOrderTitle            =&#62; &#39;Boot Mailserver&#39;,                # (optional)
        WorkOrderInstruction      =&#62; &#39;Press the button.&#39;,              # (optional)
        WorkOrderReport           =&#62; &#39;Mailserver has booted.&#39;,         # (optional)

        # search in C&#60;workorder&#62; (array params)
        WorkOrderStates   =&#62; [ &#39;accepted&#39;, &#39;ready&#39; ],                  # (optional)
        WorkOrderStateIDs =&#62; [ 1, 2, 3 ],                              # (optional)
        WorkOrderTypes    =&#62; [ &#39;workorder&#39;, &#39;backout&#39;, &#39;approval&#39; ],   # (optional)
        WorkOrderTypeIDs  =&#62; [ 5, 6, 7 ],                              # (optional)

        # changes with planned start time after ...
        PlannedStartTimeNewerDate =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # changes with planned start time before then ....
        PlannedStartTimeOlderDate =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # changes with planned end time after ...
        PlannedEndTimeNewerDate   =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # changes with planned end time before then ....
        PlannedEndTimeOlderDate   =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # changes with actual start time after ...
        ActualStartTimeNewerDate  =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # changes with actual start time before then ....
        ActualStartTimeOlderDate  =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # changes with actual end time after ...
        ActualEndTimeNewerDate    =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # changes with actual end time before then ....
        ActualEndTimeOlderDate    =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # changes with created time after ...
        CreateTimeNewerDate       =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # changes with created time before then ....
        CreateTimeOlderDate       =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # changes with changed time after ...
        ChangeTimeNewerDate       =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # changes with changed time before then ....
        ChangeTimeOlderDate       =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # changes with requested time after ...
        RequestedTimeNewerDate    =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # changes with requested time before then ....
        RequestedTimeOlderDate    =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        OrderBy =&#62; [ &#39;ChangeID&#39;, &#39;ChangeManagerID&#39; ],                  # (optional)
        # ignored when the result type is &#39;COUNT&#39;
        # default: [ &#39;ChangeID&#39; ]
        # (ChangeID, ChangeNumber, ChangeTitle, ChangeStateID,
        # ChangeManagerID, ChangeBuilderID,
        # CategoryID, ImpactID, PriorityID
        # PlannedStartTime, PlannedEndTime,
        # ActualStartTime, ActualEndTime, RequestedTime,
        # CreateTime, CreateBy, ChangeTime, ChangeBy)

        # Additional information for OrderBy:
        # The OrderByDirection can be specified for each OrderBy attribute.
        # The pairing is made by the array indices.

        OrderByDirection =&#62; [ &#39;Down&#39;, &#39;Up&#39; ],                          # (optional)
        # ignored when the result type is &#39;COUNT&#39;
        # default: [ &#39;Down&#39; ]
        # (Down | Up)

        UsingWildcards =&#62; 1,                                           # (optional)
        # (0 | 1) default 1

        Result =&#62; &#39;ARRAY&#39; || &#39;COUNT&#39;,                                  # (optional)
        # default: ARRAY, returns an array of change ids
        # COUNT returns a scalar with the number of found changes

        Limit =&#62; 100,                                                  # (optional)
        # ignored when the result type is &#39;COUNT&#39;

        MirrorDB =&#62; 1,                                                 # (optional)
        # (0 | 1) default 0
        # if set to 1 and ITSMChange::ChangeSearch::MirrorDB
        # is activated and a mirror db is configured in
        # Core::MirrorDB::DSN the change search will then use
        # the mirror db

        UserID =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeDelete()"
><a name='//apple_ref/cpp/Function/ChangeDelete()' class='dashAnchor'></a>ChangeDelete()</a></h2>

<p>Delete a change.</p>

<p>This function first removes all links and attachments to the given change. Then it gets a list of all <code>workorders</code> of the change and calls <code>WorkorderDelete()</code> for each <code>workorder</code>, which will delete all links and all attachments to the <code>workorders</code>. Then it deletes the CAB. After that the change is removed. The history of this change will be deleted during the handling of the triggered ChangeDeletePost-event.</p>

<pre>    my $Success = $ChangeObject-&#62;ChangeDelete(
        ChangeID =&#62; 123,
        UserID   =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeStateLookup()"
><a name='//apple_ref/cpp/Function/ChangeStateLookup()' class='dashAnchor'></a>ChangeStateLookup()</a></h2>

<p>This method does a lookup for a change state. If a change state id is given, it returns the name of the change state. If a change state name is given, the appropriate id is returned.</p>

<pre>    my $ChangeState = $ChangeObject-&#62;ChangeStateLookup(
        ChangeStateID =&#62; 1234,
    );

    my $ChangeStateID = $ChangeObject-&#62;ChangeStateLookup(
        ChangeState =&#62; &#39;accepted&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangePossibleStatesGet()"
><a name='//apple_ref/cpp/Function/ChangePossibleStatesGet()' class='dashAnchor'></a>ChangePossibleStatesGet()</a></h2>

<p>This method returns a list of possible change states. If ChangeID is omitted, the complete list of change states is returned. If ChangeID is given, the list of possible change states for this change is returned.</p>

<pre>    my $ChangeStateList = $ChangeObject-&#62;ChangePossibleStatesGet(
        ChangeID =&#62; 123,    # (optional)
        UserID   =&#62; 1,
    );</pre>

<p>The return value is a reference to an array of hashrefs. The element &#39;Key&#39; is then the ChangeStateID and the element &#39;Value&#39; is the name of the state. The array elements are sorted by state id.</p>

<pre>    my $ChangeStateList = [
        {
            Key   =&#62; 156,
            Value =&#62; &#39;approved&#39;,
        },
        {
            Key   =&#62; 157,
            Value =&#62; &#39;in progress&#39;,
        },
    ];</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangePossibleCIPGet()"
><a name='//apple_ref/cpp/Function/ChangePossibleCIPGet()' class='dashAnchor'></a>ChangePossibleCIPGet()</a></h2>

<p>This method returns a list of possible categories, impacts or priorities.</p>

<pre>    my $CIPList = $ChangeObject-&#62;ChangePossibleCIPGet(
        Type   =&#62; &#39;Category&#39;,  # Category|Impact|Priority
        UserID =&#62; 1,
    );</pre>

<p>The return value is a reference to an array of hashrefs. The Element &#39;Key&#39; is then the ID and the element &#39;Value&#39; is the name of the category, impact or priority. The array elements are sorted by id in ascending order.</p>

<pre>    my $CIPList = [
        {
            Key   =&#62; 156,
            Value =&#62; &#39;1 very low&#39;,
        },
        {
            Key   =&#62; 157,
            Value =&#62; &#39;2 low&#39;,
        },
    ];</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeCIPLookup()"
><a name='//apple_ref/cpp/Function/ChangeCIPLookup()' class='dashAnchor'></a>ChangeCIPLookup()</a></h2>

<p>This method does a lookup for a change category, impact or priority. If a change <code>CIP-ID</code> is given, it returns the name of the <code>CIP</code>. If a change <code>CIP</code> name is given, the appropriate ID is returned.</p>

<pre>    my $Name = $ChangeObject-&#62;ChangeCIPLookup(
        ID   =&#62; 1234,
        Type =&#62; &#39;Priority&#39;,
    );

    my $ID = $ChangeObject-&#62;ChangeCIPLookup(
        CIP  =&#62; &#39;1 very low&#39;,
        Type =&#62; &#39;Category&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Permission()"
><a name='//apple_ref/cpp/Function/Permission()' class='dashAnchor'></a>Permission()</a></h2>

<p>Returns whether the agent <code>UserID</code> has permissions of the type <code>Type</code> on the change <code>ChangeID</code>. The parameters are passed on to the permission modules that were registered in the permission registry. The standard permission registry is <b>ITSMChange::Permission</b>, but that can be overridden with the parameter <code>PermissionRegistry</code>.</p>

<p>The optional option <code>LogNo</code> turns off logging when access was denied. This is useful when the method is used for checking whether a link or an action should be shown.</p>

<pre>    my $Access = $ChangeObject-&#62;Permission(
        UserID             =&#62; 123,
        Type               =&#62; &#39;ro&#39;,                         # &#39;ro&#39; and &#39;rw&#39; are supported
        Action             =&#62; &#39;AgentITSMChangeEdit&#39;,        # optional
        ChangeID           =&#62; 3333,   # optional, do not pass for &#39;ChangeAdd&#39;
        PermissionRegistry =&#62; &#39;ITSMChange::Permission&#39;,
                                      # optional with default &#39;ITSMChange::Permission&#39;
        LogNo              =&#62; 1,      # optional, turns off logging when access is denied
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeAttachmentAdd()"
><a name='//apple_ref/cpp/Function/ChangeAttachmentAdd()' class='dashAnchor'></a>ChangeAttachmentAdd()</a></h2>

<p>Add an attachment to the given change.</p>

<pre>    my $Success = $ChangeObject-&#62;ChangeAttachmentAdd(
        ChangeID    =&#62; 123,               # the ChangeID becomes part of the file path
        Filename    =&#62; &#39;filename&#39;,
        Content     =&#62; &#39;content&#39;,
        ContentType =&#62; &#39;text/plain&#39;,
        UserID      =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeAttachmentDelete()"
><a name='//apple_ref/cpp/Function/ChangeAttachmentDelete()' class='dashAnchor'></a>ChangeAttachmentDelete()</a></h2>

<p>Delete the given file from the virtual filesystem.</p>

<pre>    my $Success = $ChangeObject-&#62;ChangeAttachmentDelete(
        ChangeID =&#62; 123,      # used in event handling, e.g. for logging the history
        Filename =&#62; &#39;Projectplan.pdf&#39;,     # identifies the attachment (together with the ChangeID)
        UserID   =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeAttachmentGet()"
><a name='//apple_ref/cpp/Function/ChangeAttachmentGet()' class='dashAnchor'></a>ChangeAttachmentGet()</a></h2>

<p>This method returns information about one specific attachment.</p>

<pre>    my $Attachment = $ChangeObject-&#62;ChangeAttachmentGet(
        ChangeID =&#62; 4,
        Filename =&#62; &#39;test.txt&#39;,
    );</pre>

<p>returns</p>

<pre>    {
        Preferences =&#62; {
            AllPreferences =&#62; &#39;test&#39;,
        },
        Filename    =&#62; &#39;test.txt&#39;,
        Content     =&#62; &#39;hallo&#39;,
        ContentType =&#62; &#39;text/plain&#39;,
        Filesize    =&#62; &#39;123 KBytes&#39;,
        Type        =&#62; &#39;attachment&#39;,
    }</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeAttachmentList()"
><a name='//apple_ref/cpp/Function/ChangeAttachmentList()' class='dashAnchor'></a>ChangeAttachmentList()</a></h2>

<p>Returns an array with all attachments of the given change.</p>

<pre>    my @Attachments = $ChangeObject-&#62;ChangeAttachmentList(
        ChangeID =&#62; 123,
    );</pre>

<p>returns</p>

<pre>    @Attachments = (
        &#39;filename.txt&#39;,
        &#39;other_file.pdf&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="ChangeAttachmentExists()"
><a name='//apple_ref/cpp/Function/ChangeAttachmentExists()' class='dashAnchor'></a>ChangeAttachmentExists()</a></h2>

<p>Checks if a file with a given filename exists.</p>

<pre>    my $Exists = $ChangeObject-&#62;ChangeAttachmentExists(
        Filename =&#62; &#39;test.txt&#39;,
        ChangeID =&#62; 123,
        UserID   =&#62; 1,
    );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVATE_INTERFACE"
><a name='//apple_ref/cpp/Class/PRIVATE INTERFACE' class='dashAnchor'></a>PRIVATE INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_CheckChangeStateIDs()"
><a name='//apple_ref/cpp/Function/_CheckChangeStateIDs()' class='dashAnchor'></a>_CheckChangeStateIDs()</a></h2>

<p>Check whether all of the given change state ids are valid.</p>

<pre>    my $Ok = $ChangeObject-&#62;_CheckChangeStateIDs(
        ChangeStateIDs =&#62; [ 25, 26 ],
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_CheckChangeCIPIDs()"
><a name='//apple_ref/cpp/Function/_CheckChangeCIPIDs()' class='dashAnchor'></a>_CheckChangeCIPIDs()</a></h2>

<p>Check whether all of the given ids of category, impact or priority are valid.</p>

<pre>    my $Ok = $ChangeObject-&#62;_CheckChangeCIPIDs(
        IDs  =&#62; [ 25, 26 ], # mandatory
        Type =&#62; &#39;Priority&#39;, # mandatory (Category|Impact|Priority)
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_CheckChangeParams()"
><a name='//apple_ref/cpp/Function/_CheckChangeParams()' class='dashAnchor'></a>_CheckChangeParams()</a></h2>

<p>Checks the params to ChangeAdd() and ChangeUpdate(). There are no required parameters.</p>

<pre>    my $Ok = $ChangeObject-&#62;_CheckChangeParams(
        ChangeTitle          =&#62; &#39;Replacement of mail server&#39;,       # (optional)
        Description          =&#62; &#39;New mail server &#60;b&#62;is&#60;/b&#62; faster&#39;, # (optional)
        DescriptionPlain     =&#62; &#39;New mail server is faster&#39;,        # (optional)
        Justification        =&#62; &#39;Old mail server&#60;b&#62;too&#60;/b&#62; slow&#39;,   # (optional)
        JustificationPlain   =&#62; &#39;Old mail server too slow&#39;,         # (optional)
        ChangeStateID        =&#62; 4,                                  # (optional)
        ChangeManagerID      =&#62; 5,                                  # (optional)
        ChangeBuilderID      =&#62; 6,                                  # (optional)
        CategoryID           =&#62; 7,                                  # (optional)
        ImpactID             =&#62; 8,                                  # (optional)
        PriorityID           =&#62; 9,                                  # (optional)
        RequestedTime        =&#62; &#39;2009-10-23 08:57:12&#39;,              # (optional)
        CABAgents            =&#62; [ 1, 2, 4 ],     # UserIDs          # (optional)
        CABCustomers         =&#62; [ &#39;tt&#39;, &#39;mm&#39; ],  # CustomerUserIDs  # (optional)
        DynamicField_X       =&#62; &#39;Sun&#39;,                              # (optional)
        DynamicField_Y       =&#62; &#39;Earth&#39;,                            # (optional)
    );</pre>

<p>The ChangeStateID is checked for existence in the general catalog. These string parameters have length constraints:</p>

<pre>    Parameter           | max. length
    --------------------+-----------------
    ChangeTitle         |  250 characters
    Description         | 1800000 characters
    DescriptionPlain    | 1800000 characters
    Justification       | 1800000 characters
    JustificationPlain  | 1800000 characters
    DynamicField_X      | 3800 characters
    DynamicField_Y      | 3800 characters</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TERMS_AND_CONDITIONS"
><a name='//apple_ref/cpp/Class/TERMS AND CONDITIONS' class='dashAnchor'></a>TERMS AND CONDITIONS</a></h1>

<p>This software is part of the OTRS project (<a href="https://otrs.org/" class="podlinkurl"
>https://otrs.org/</a>).</p>

<p>This software comes with ABSOLUTELY NO WARRANTY. For details, see the enclosed file COPYING for license information (GPL). If you did not receive this file, see <a href="https://www.gnu.org/licenses/gpl-3.0.txt" class="podlinkurl"
>https://www.gnu.org/licenses/gpl-3.0.txt</a>.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
