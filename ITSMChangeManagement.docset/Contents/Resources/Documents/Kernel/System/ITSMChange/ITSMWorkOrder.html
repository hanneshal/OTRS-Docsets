<html><head><title>Kernel::System::ITSMChange::ITSMWorkOrder</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.28,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018004 at Tue Feb 16 20:51:27 2021 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#PUBLIC_INTERFACE'>PUBLIC INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#new()'>new()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderAdd()'>WorkOrderAdd()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderUpdate()'>WorkOrderUpdate()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderGet()'>WorkOrderGet()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderList()'>WorkOrderList()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderSearch()'>WorkOrderSearch()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderDelete()'>WorkOrderDelete()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderChangeTimeGet()'>WorkOrderChangeTimeGet()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderStateLookup()'>WorkOrderStateLookup()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderPossibleStatesGet()'>WorkOrderPossibleStatesGet()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderTypeLookup()'>WorkOrderTypeLookup()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderTypeList()'>WorkOrderTypeList()</a>
    <li class='indexItem indexItem2'><a href='#Permission()'>Permission()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderStateIDsCheck()'>WorkOrderStateIDsCheck()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderAttachmentAdd()'>WorkOrderAttachmentAdd()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderAttachmentDelete()'>WorkOrderAttachmentDelete()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderAttachmentGet()'>WorkOrderAttachmentGet()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderAttachmentList()'>WorkOrderAttachmentList()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderReportAttachmentList()'>WorkOrderReportAttachmentList()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderAttachmentExists()'>WorkOrderAttachmentExists()</a>
    <li class='indexItem indexItem2'><a href='#WorkOrderChangeEffortsGet()'>WorkOrderChangeEffortsGet()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#PRIVATE_INTERFACE'>PRIVATE INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#_CheckWorkOrderTypeIDs()'>_CheckWorkOrderTypeIDs()</a>
    <li class='indexItem indexItem2'><a href='#_GetWorkOrderNumber()'>_GetWorkOrderNumber()</a>
    <li class='indexItem indexItem2'><a href='#_CheckWorkOrderParams()'>_CheckWorkOrderParams()</a>
    <li class='indexItem indexItem2'><a href='#_CheckTimestamps()'>_CheckTimestamps()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#TERMS_AND_CONDITIONS'>TERMS AND CONDITIONS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
><a name='//apple_ref/cpp/Class/NAME' class='dashAnchor'></a>NAME</a></h1>

<p>Kernel::System::ITSMChange::ITSMWorkOrder - workorder lib</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PUBLIC_INTERFACE"
><a name='//apple_ref/cpp/Class/PUBLIC INTERFACE' class='dashAnchor'></a>PUBLIC INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="new()"
><a name='//apple_ref/cpp/Function/new()' class='dashAnchor'></a>new()</a></h2>

<p>create an object</p>

<pre>    use Kernel::System::ObjectManager;
    local $Kernel::OM = Kernel::System::ObjectManager-&#62;new();
    my $WorkOrderObject = $Kernel::OM-&#62;Get(&#39;Kernel::System::ITSMChange::ITSMWorkOrder&#39;);</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderAdd()"
><a name='//apple_ref/cpp/Function/WorkOrderAdd()' class='dashAnchor'></a>WorkOrderAdd()</a></h2>

<p>Add a new <code>workorder</code>. Internally first a minimal <code>workorder</code> is created, then WorkOrderUpdate() is called for setting the remaining arguments.</p>

<pre>    my $WorkOrderID = $WorkOrderObject-&#62;WorkOrderAdd(
        ChangeID =&#62; 123,
        UserID   =&#62; 1,
    );</pre>

<p>or</p>

<pre>    my $WorkOrderID = $WorkOrderObject-&#62;WorkOrderAdd(
        ChangeID           =&#62; 123,
        WorkOrderTitle     =&#62; &#39;Replacement of mail server&#39;,              # (optional)
        Instruction        =&#62; &#39;Install the the new server&#39;,              # (optional)
        Report             =&#62; &#39;Installed new server without problems&#39;,   # (optional)
        WorkOrderStateID   =&#62; 157,                                       # (optional) or WorkOrderState =&#62; &#39;ready&#39;
        WorkOrderState     =&#62; &#39;ready&#39;,                                   # (optional) or WorkOrderStateID =&#62; 157
        WorkOrderTypeID    =&#62; 161,                                       # (optional) or WorkOrderType =&#62; &#39;pir&#39;
        WorkOrderType      =&#62; &#39;ready&#39;,                                   # (optional) or WorkOrderTypeID =&#62; 161
        WorkOrderAgentID   =&#62; 8,                                         # (optional)
        PlannedStartTime   =&#62; &#39;2009-10-12 00:00:01&#39;,                     # (optional)
        PlannedEndTime     =&#62; &#39;2009-10-15 15:00:00&#39;,                     # (optional)
        ActualStartTime    =&#62; &#39;2009-10-14 00:00:01&#39;,                     # (optional)
        ActualEndTime      =&#62; &#39;2009-01-20 00:00:01&#39;,                     # (optional)
        PlannedEffort      =&#62; 123,                                       # (optional)
        DynamicField_X     =&#62; &#39;Sun&#39;,                                     # (optional)
        DynamicField_Y     =&#62; &#39;Earth&#39;,                                   # (optional)
        UserID             =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderUpdate()"
><a name='//apple_ref/cpp/Function/WorkOrderUpdate()' class='dashAnchor'></a>WorkOrderUpdate()</a></h2>

<p>Update a <code>workorder</code>. Leading and trailing whitespace is removed from <code>WorkOrderTitle</code>. Passing undefined values is generally not allowed. An exception are the parameters <code>PlannedStartTime</code>, <code>PlannedEndTime</code>, <code>ActualStartTime</code>, and <code>ActualEndTime</code>. There passing <code>undef</code> indicates that the <code>workorder</code> time should be cleared. Another exception is the WorkOrderAgentID. Pass undef for removing the <code>workorder</code> agent.</p>

<pre>    my $Success = $WorkOrderObject-&#62;WorkOrderUpdate(
        WorkOrderID        =&#62; 4,
        WorkOrderNumber    =&#62; 5,                                         # (optional)
        WorkOrderTitle     =&#62; &#39;Replacement of mail server&#39;,              # (optional)
        Instruction        =&#62; &#39;Install the the new server&#39;,              # (optional)
        Report             =&#62; &#39;Installed new server without problems&#39;,   # (optional)
        WorkOrderStateID   =&#62; 157,                                       # (optional) or WorkOrderState =&#62; &#39;ready&#39;
        WorkOrderState     =&#62; &#39;ready&#39;,                                   # (optional) or WorkOrderStateID =&#62; 157
        WorkOrderTypeID    =&#62; 161,                                       # (optional) or WorkOrderType =&#62; &#39;pir&#39;
        WorkOrderType      =&#62; &#39;pir&#39;,                                     # (optional) or WorkOrderStateID =&#62; 161
        WorkOrderAgentID   =&#62; 8,                                         # (optional) can be undef for removing the workorder agent
        PlannedStartTime   =&#62; &#39;2009-10-12 00:00:01&#39;,                     # (optional) &#39;undef&#39; indicates clearing
        PlannedEndTime     =&#62; &#39;2009-10-15 15:00:00&#39;,                     # (optional) &#39;undef&#39; indicates clearing
        ActualStartTime    =&#62; &#39;2009-10-14 00:00:01&#39;,                     # (optional) &#39;undef&#39; indicates clearing
        ActualEndTime      =&#62; &#39;2009-01-20 00:00:01&#39;,                     # (optional) &#39;undef&#39; indicates clearing
        PlannedEffort      =&#62; 123,                                       # (optional)
        AccountedTime      =&#62; 13,                                        # (optional) the value is added to the value in the database
        DynamicField_X     =&#62; &#39;Sun&#39;,                                     # (optional)
        DynamicField_Y     =&#62; &#39;Earth&#39;,                                   # (optional)
        NoNumberCalc       =&#62; 1,                                         # (optional) default 0, if 1 it prevents a recalculation of the workorder numbers
        BypassStateMachine =&#62; 1,                                         # (optional) default 0, if 1 the state machine will be bypassed
        UserID             =&#62; 1,
    );</pre>

<p>Constraints:</p>

<p><code>xxxStartTime</code> has to be before <code>xxxEndTime</code>. If just one of the parameter pair is passed the other time is retrieved from database. The <code>WorkOrderStateID</code> is checked against the state machine.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderGet()"
><a name='//apple_ref/cpp/Function/WorkOrderGet()' class='dashAnchor'></a>WorkOrderGet()</a></h2>

<p>Return a <code>WorkOrder</code> as hash reference. When the <code>workorder</code> does not exist, a false value is returned. The optional option <code>LogNo</code> turns off logging when the <code>workorder</code> does not exist.</p>

<pre>    my $WorkOrderRef = $WorkOrderObject-&#62;WorkOrderGet(
        WorkOrderID =&#62; 123,
        UserID      =&#62; 1,
        LogNo       =&#62; 1,      # optional, turns off logging when the workorder does not exist
    );</pre>

<p>The returned hash reference contains following elements:</p>

<pre>    $WorkOrder{WorkOrderID}
    $WorkOrder{ChangeID}
    $WorkOrder{WorkOrderNumber}
    $WorkOrder{WorkOrderTitle}
    $WorkOrder{Instruction}
    $WorkOrder{InstructionPlain}
    $WorkOrder{Report}
    $WorkOrder{ReportPlain}
    $WorkOrder{WorkOrderStateID}
    $WorkOrder{WorkOrderState}              # fetched from the general catalog
    $WorkOrder{WorkOrderStateSignal}        # fetched from SysConfig
    $WorkOrder{WorkOrderTypeID}
    $WorkOrder{WorkOrderType}               # fetched from the general catalog
    $WorkOrder{WorkOrderAgentID}
    $WorkOrder{PlannedStartTime}
    $WorkOrder{PlannedEndTime}
    $WorkOrder{ActualStartTime}
    $WorkOrder{ActualEndTime}
    $WorkOrder{AccountedTime}
    $WorkOrder{PlannedEffort}
    $WorkOrder{DynamicField_X}
    $WorkOrder{DynamicField_Y}
    $WorkOrder{CreateTime}
    $WorkOrder{CreateBy}
    $WorkOrder{ChangeTime}
    $WorkOrder{ChangeBy}</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderList()"
><a name='//apple_ref/cpp/Function/WorkOrderList()' class='dashAnchor'></a>WorkOrderList()</a></h2>

<p>Return a list of all <code>workorder</code> ids of the given change as array reference. The <code>workorder</code> ids are ordered by <code>workorder</code> number.</p>

<pre>    my $WorkOrderIDsRef = $WorkOrderObject-&#62;WorkOrderList(
        ChangeID =&#62; 5,
        UserID   =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderSearch()"
><a name='//apple_ref/cpp/Function/WorkOrderSearch()' class='dashAnchor'></a>WorkOrderSearch()</a></h2>

<p>Returns either a list, as an arrayref, or a count of found <code>workorder</code> ids. The count of results is returned when the parameter <code>Result =</code> &#39;COUNT&#39;&#62; is passed.</p>

<p>The search criteria are logically AND connected. When a list is passed as <code>criterium</code>, the individual members are OR connected. When an undef or a reference to an empty array is passed, then the search <code>criterium</code> is ignored.</p>

<pre>    my $WorkOrderIDsRef = $WorkOrderObject-&#62;WorkOrderSearch(
        ChangeIDs         =&#62; [ 123, 122 ]                              # (optional)
        WorkOrderNumber   =&#62; 12,                                       # (optional)

        WorkOrderTitle    =&#62; &#39;Replacement of mail server&#39;,             # (optional)
        Instruction       =&#62; &#39;Install the the new server&#39;,             # (optional)
        Report            =&#62; &#39;Installed new server without problems&#39;,  # (optional)

        # DynamicFields (for workorders)
        #   At least one operator must be specified. Operators will be connected with AND,
        #       values in an operator with OR.
        #   You can also pass more than one argument to an operator: [&#39;value1&#39;, &#39;value2&#39;]
        DynamicField_FieldNameX =&#62; {
            Equals            =&#62; 123,
            Like              =&#62; &#39;value*&#39;,                # &#34;equals&#34; operator with wildcard support
            GreaterThan       =&#62; &#39;2001-01-01 01:01:01&#39;,
            GreaterThanEquals =&#62; &#39;2001-01-01 01:01:01&#39;,
            SmallerThan       =&#62; &#39;2002-02-02 02:02:02&#39;,
            SmallerThanEquals =&#62; &#39;2002-02-02 02:02:02&#39;,
        }

        WorkOrderStateIDs =&#62; [ 11, 12 ],                               # (optional)
        WorkOrderStates   =&#62; [ &#39;closed&#39;, &#39;canceled&#39; ],                 # (optional)

        WorkOrderTypeIDs  =&#62; [ 21, 22 ],                               # (optional)
        WorkOrderTypes    =&#62; [ &#39;approval&#39;, &#39;workorder&#39; ],              # (optional)

        WorkOrderAgentIDs =&#62; [ 1, 2, 3 ],                              # (optional)
        CreateBy          =&#62; [ 5, 2, 3 ],                              # (optional)
        ChangeBy          =&#62; [ 3, 2, 1 ],                              # (optional)

        # search in text fields of change object
        ChangeNumber        =&#62; &#39;Number of change&#39;,                     # (optional)
        ChangeTitle         =&#62; &#39;Title of change&#39;,                      # (optional)
        ChangeDescription   =&#62; &#39;Description of change&#39;,                # (optional)
        ChangeJustification =&#62; &#39;Justification of change&#39;,              # (optional)

        # workorders with planned start time after ...
        PlannedStartTimeNewerDate =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # workorders with planned start time before then ....
        PlannedStartTimeOlderDate =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # workorders with planned end time after ...
        PlannedEndTimeNewerDate   =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # workorders with planned end time before then ....
        PlannedEndTimeOlderDate   =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # workorders with actual start time after ...
        ActualStartTimeNewerDate  =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # workorders with actual start time before then ....
        ActualStartTimeOlderDate  =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # workorders with actual end time after ...
        ActualEndTimeNewerDate    =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # workorders with actual end time before then ....
        ActualEndTimeOlderDate    =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # workorders with created time after ...
        CreateTimeNewerDate       =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # workorders with created time before then ....
        CreateTimeOlderDate       =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        # workorders with changed time after ...
        ChangeTimeNewerDate       =&#62; &#39;2006-01-09 00:00:01&#39;,            # (optional)
        # workorders with changed time before then ....
        ChangeTimeOlderDate       =&#62; &#39;2006-01-19 23:59:59&#39;,            # (optional)

        OrderBy =&#62; [ &#39;ChangeID&#39;, &#39;WorkOrderNumber&#39; ],                  # (optional)
        # ignored when the result type is &#39;COUNT&#39;
        # default: [ &#39;WorkOrderID&#39; ],
        # (WorkOrderID, ChangeID, WorkOrderNumber, WorkOrderTitle
        # WorkOrderStateID, WorkOrderTypeID, WorkOrderAgentID,
        # PlannedStartTime, PlannedEndTime,
        # ActualStartTime, ActualEndTime,
        # CreateTime, CreateBy, ChangeTime, ChangeBy)

        # Additional information for OrderBy:
        # The OrderByDirection can be specified for each OrderBy attribute.
        # The pairing is made by the array indices.

        OrderByDirection =&#62; [ &#39;Down&#39;, &#39;Up&#39; ],                          # (optional)
        # ignored when the result type is &#39;COUNT&#39;
        # default: [ &#39;Down&#39; ]
        # (Down | Up)

        UsingWildcards =&#62; 1,                                           # (optional)
        # (0 | 1) default 1

        Result =&#62; &#39;ARRAY&#39; || &#39;COUNT&#39;,                                  # (optional)
        # default: ARRAY, returns an array of workorder ids
        # COUNT returns a scalar with the number of found workorders

        Limit =&#62; 100,                                                  # (optional)
        # ignored when the result type is &#39;COUNT&#39;

        MirrorDB =&#62; 1,                                                 # (optional)
        # (0 | 1) default 0
        # if set to 1 and ITSMChange::ChangeSearch::MirrorDB
        # is activated and a mirror db is configured in
        # Core::MirrorDB::DSN the workorder search will then use
        # the mirror db

        UserID =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderDelete()"
><a name='//apple_ref/cpp/Function/WorkOrderDelete()' class='dashAnchor'></a>WorkOrderDelete()</a></h2>

<p>Delete a <code>workorder</code>.</p>

<p>This function removes all links and attachments to the <code>workorder</code> with the passed <code>workorder</code> id. After that the <code>workorder</code> is removed.</p>

<pre>    my $Success = $WorkOrderObject-&#62;WorkOrderDelete(
        WorkOrderID  =&#62; 123,
        NoNumberCalc =&#62; 1, # (optional) default 0, if 1 it prevents a recalculation of the workorder numbers
        UserID       =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderChangeTimeGet()"
><a name='//apple_ref/cpp/Function/WorkOrderChangeTimeGet()' class='dashAnchor'></a>WorkOrderChangeTimeGet()</a></h2>

<p>Returns a list of PlannedStartTime | PlannedEndTime | ActualStartTime | ActualEndTime of a change, which would be the respective time of the earliest starting <code>workorder</code> (for start times) or the latest ending <code>workorder</code> (for end times).</p>

<p>For PlannedStartTime | PlannedEndTime | ActualEndTime an empty string is returned if any of the <code>workorders</code> of a change has the respective time not defined.</p>

<p>The ActualStartTime is defined when any of the <code>workorders</code> of a change has a defined ActualStartTime.</p>

<p>Return</p>

<pre>    $Time{PlannedStartTime}
    $Time{PlannedEndTime}
    $Time{ActualStartTime}
    $Time{ActualEndTime}

    my $TimeRef = $WorkOrderObject-&#62;WorkOrderChangeTimeGet(
        ChangeID =&#62; 123,
        UserID   =&#62; 1,

        # ---------------------------------------------------- #

        # TODO: (decide this later!)
        Maybe add this new attribute:

        # These are WorkOrderTypes (Types, not States!)
        # which would be excluded from the calculation
        # of the change start time.

        ExcludeWorkOrderTypes =&#62; [ &#39;approval&#39;, &#39;pir&#39; ],   # (optional)

        # ---------------------------------------------------- #
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderStateLookup()"
><a name='//apple_ref/cpp/Function/WorkOrderStateLookup()' class='dashAnchor'></a>WorkOrderStateLookup()</a></h2>

<p>This method does a lookup for a <code>workorder</code> state. If a <code>workorder</code> state id is given, it returns the name of the <code>workorder</code> state. If a <code>workorder</code> state name is given, the appropriate id is returned.</p>

<pre>    my $WorkOrderState = $WorkOrderObject-&#62;WorkOrderStateLookup(
        WorkOrderStateID =&#62; 157,
    );

    my $WorkOrderStateID = $WorkOrderObject-&#62;WorkOrderStateLookup(
        WorkOrderState =&#62; &#39;ready&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderPossibleStatesGet()"
><a name='//apple_ref/cpp/Function/WorkOrderPossibleStatesGet()' class='dashAnchor'></a>WorkOrderPossibleStatesGet()</a></h2>

<p>This method returns a list of possible <code>workorder</code> states. If <code>WorkOrderID</code> is omitted, the complete list of <code>workorder</code> states is returned. If <code>WorkOrderID</code> is given, the list of possible states for the given <code>workorder</code> is returned.</p>

<pre>    my $WorkOrderStateList = $WorkOrderObject-&#62;WorkOrderPossibleStatesGet(
        WorkOrderID =&#62; 123,  # (optional)
        UserID      =&#62; 1,
    );</pre>

<p>The return value is a reference to an array of hashrefs. The element &#39;Key&#39; is then the StateID and the element &#39;Value&#39; is the name of the state. The array elements are sorted by state id.</p>

<pre>    my $WorkOrderStateList = [
        {
            Key   =&#62; 156,
            Value =&#62; &#39;accepted&#39;,
        },
        {
            Key   =&#62; 157,
            Value =&#62; &#39;in progress&#39;,
        },
    ];</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderTypeLookup()"
><a name='//apple_ref/cpp/Function/WorkOrderTypeLookup()' class='dashAnchor'></a>WorkOrderTypeLookup()</a></h2>

<p>This method does a lookup for a <code>workorder</code> type. If a <code>workorder</code> type id is given, it returns the name of the <code>workorder</code> type. If a <code>workorder</code> type name is given, the appropriate id is returned.</p>

<pre>    my $WorkOrderType = $WorkOrderObject-&#62;WorkOrderTypeLookup(
        WorkOrderTypeID =&#62; 157,
    );

    my $WorkOrderTypeID = $WorkOrderObject-&#62;WorkOrderTypeLookup(
        WorkOrderType =&#62; &#39;ready&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderTypeList()"
><a name='//apple_ref/cpp/Function/WorkOrderTypeList()' class='dashAnchor'></a>WorkOrderTypeList()</a></h2>

<p>This method returns a list of all <code>workorder</code> types.</p>

<pre>    my $WorkOrderTypeList = $WorkOrderObject-&#62;WorkOrderTypeList(
        UserID      =&#62; 1,
        Default     =&#62; 1,   # optional - the default type is selected type (default: 0)
        SelectedID  =&#62; 123, # optional - this id is selected
    );</pre>

<p>The return value is a reference to an array of hashrefs. The Element &#39;Key&#39; is then the TypeID and die Element &#39;Value&#39; is the name of the type. The array elements are sorted by type id.</p>

<pre>    my $WorkOrderTypeList = [
        {
            Key   =&#62; 171,
            Value =&#62; &#39;workorder&#39;,
        },
        {
            Key   =&#62; 172,
            Value =&#62; &#39;backout&#39;,
        },
    ];</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="Permission()"
><a name='//apple_ref/cpp/Function/Permission()' class='dashAnchor'></a>Permission()</a></h2>

<p>Returns whether the agent <code>UserID</code> has permissions of the type <code>Type</code> on the <code>workorder</code> <code>WorkOrderID</code>. The parameters are passed on to the permission modules that were registered in the permission registry. The standard permission registry is <b>ITSMWorkOrder::Permission</b>, but that can be overridden with the parameter <code>PermissionRegistry</code>.</p>

<p>The registered permission modules are run in the alphabetical order of their registry keys. Overall permission is granted when a permission module, which has the attribute &#39;Granted&#39; set, grants permission. Overall permission is denied when a permission module, which has the attribute &#39;Required&#39; set, denies permission. Overall permission is also denied when when all permission module were asked without coming to an conclusion.</p>

<p>Approval is indicated by the return value 1. Denial is indicated by returning an empty list.</p>

<p>The optional option <code>LogNo</code> turns off logging when access was denied. This is useful when the method is used for checking whether a link or an action should be shown.</p>

<pre>    my $Access = $WorkOrderObject-&#62;Permission(
        UserID             =&#62; 123,
        Type               =&#62; &#39;ro&#39;,                         # &#39;ro&#39; and &#39;rw&#39; are supported
        Action             =&#62; &#39;AgentITSMWorkOrderReport&#39;,   # optional
        WorkOrderID        =&#62; 4444,
        PermissionRegistry =&#62; &#39;ITSMWorkOrder::TakePermission&#39;,
                                      # optional with default &#39;ITSMWorkOrder::Permission&#39;
        LogNo              =&#62; 1,      # optional, turns off logging when access is denied
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderStateIDsCheck()"
><a name='//apple_ref/cpp/Function/WorkOrderStateIDsCheck()' class='dashAnchor'></a>WorkOrderStateIDsCheck()</a></h2>

<p>Check whether all of the given <code>workorder</code> state ids are valid. The method is public as it is used in <a href="../../../Kernel/System/ITSMChange/ChangeSearch.html" class="podlinkpod"
>Kernel::System::ITSMChange::ChangeSearch</a>.</p>

<pre>    my $Ok = $WorkOrderObject-&#62;WorkOrderStateIDsCheck(
        WorkOrderStateIDs =&#62; [ 25 ],
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderAttachmentAdd()"
><a name='//apple_ref/cpp/Function/WorkOrderAttachmentAdd()' class='dashAnchor'></a>WorkOrderAttachmentAdd()</a></h2>

<p>Add an attachment to the given <code>workorder</code>.</p>

<pre>    my $Success = $WorkOrderObject-&#62;WorkOrderAttachmentAdd(
        ChangeID       =&#62; 123,
        WorkOrderID    =&#62; 456,            # the WorkOrderID becomes part of the file path
        AttachmentType =&#62; &#39;WorkOrder&#39;,    # ( &#39;WorkOrder&#39; || &#39;WorkOrderReport&#39;)  (optional, default &#39;WorkOrder&#39; )
        Filename       =&#62; &#39;filename&#39;,
        Content        =&#62; &#39;content&#39;,
        ContentType    =&#62; &#39;text/plain&#39;,
        UserID         =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderAttachmentDelete()"
><a name='//apple_ref/cpp/Function/WorkOrderAttachmentDelete()' class='dashAnchor'></a>WorkOrderAttachmentDelete()</a></h2>

<p>Delete the given file from the virtual filesystem.</p>

<pre>    my $Success = $WorkOrderObject-&#62;WorkOrderAttachmentDelete(
        ChangeID       =&#62; 12345,
        WorkOrderID    =&#62; 5123,
        AttachmentType =&#62; &#39;WorkOrder&#39;,           # ( &#39;WorkOrder&#39; || &#39;WorkOrderReport&#39;)  (optional, default &#39;WorkOrder&#39; )
        Filename       =&#62; &#39;Projectplan.pdf&#39;,     # identifies the attachment (together with the WorkOrderID)
        UserID         =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderAttachmentGet()"
><a name='//apple_ref/cpp/Function/WorkOrderAttachmentGet()' class='dashAnchor'></a>WorkOrderAttachmentGet()</a></h2>

<p>This method returns information about one specific attachment.</p>

<pre>    my $Attachment = $WorkOrderObject-&#62;WorkOrderAttachmentGet(
        WorkOrderID    =&#62; 4,
        AttachmentType =&#62; &#39;WorkOrder&#39;,    # ( &#39;WorkOrder&#39; || &#39;WorkOrderReport&#39;)  (optional, default &#39;WorkOrder&#39; )
        Filename       =&#62; &#39;test.txt&#39;,
    );</pre>

<p>returns</p>

<pre>    $Attachment = {
        Preferences =&#62; {
            AllPreferences =&#62; &#39;test&#39;,
        },
        Filename       =&#62; &#39;test.txt&#39;,
        Content        =&#62; &#39;hallo&#39;,
        ContentType    =&#62; &#39;text/plain&#39;,
        Filesize       =&#62; &#39;123 KBytes&#39;,
        Type           =&#62; &#39;attachment&#39;,
        AttachmentType =&#62; &#39;WorkOrder&#39;,
    };</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderAttachmentList()"
><a name='//apple_ref/cpp/Function/WorkOrderAttachmentList()' class='dashAnchor'></a>WorkOrderAttachmentList()</a></h2>

<p>Returns an array with all <code>workorder</code> attachments (not the report attachments) of the given <code>workorder</code>.</p>

<pre>    my @Attachments = $WorkOrderObject-&#62;WorkOrderAttachmentList(
        WorkOrderID =&#62; 123,
    );</pre>

<p>returns</p>

<pre>    @Attachments = (
        &#39;filename.txt&#39;,
        &#39;other_file.pdf&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderReportAttachmentList()"
><a name='//apple_ref/cpp/Function/WorkOrderReportAttachmentList()' class='dashAnchor'></a>WorkOrderReportAttachmentList()</a></h2>

<p>Returns an array with all report attachments of the given <code>workorder</code>.</p>

<pre>    my @Attachments = $WorkOrderObject-&#62;WorkOrderReportAttachmentList(
        WorkOrderID =&#62; 123,
    );</pre>

<p>returns</p>

<pre>    @Attachments = (
        &#39;filename.txt&#39;,
        &#39;other_file.pdf&#39;,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderAttachmentExists()"
><a name='//apple_ref/cpp/Function/WorkOrderAttachmentExists()' class='dashAnchor'></a>WorkOrderAttachmentExists()</a></h2>

<p>Checks if a file with a given filename exists.</p>

<pre>    my $Exists = $WorkOrderObject-&#62;WorkOrderAttachmentExists(
        Filename       =&#62; &#39;test.txt&#39;,
        WorkOrderID    =&#62; 123,
        AttachmentType =&#62; &#39;WorkOrder&#39;,    # ( &#39;WorkOrder&#39; || &#39;WorkOrderReport&#39;)  (optional, default &#39;WorkOrder&#39; )
        UserID         =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="WorkOrderChangeEffortsGet()"
><a name='//apple_ref/cpp/Function/WorkOrderChangeEffortsGet()' class='dashAnchor'></a>WorkOrderChangeEffortsGet()</a></h2>

<p>returns the combined efforts of the <code>workorders</code> for the given change</p>

<pre>    my $ChangeEfforts = $WorkOrderObject-&#62;WorkOrderChangeEffortsGet(
        ChangeID =&#62; 123,
        UserID   =&#62; 1,
    );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PRIVATE_INTERFACE"
><a name='//apple_ref/cpp/Class/PRIVATE INTERFACE' class='dashAnchor'></a>PRIVATE INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_CheckWorkOrderTypeIDs()"
><a name='//apple_ref/cpp/Function/_CheckWorkOrderTypeIDs()' class='dashAnchor'></a>_CheckWorkOrderTypeIDs()</a></h2>

<p>check whether the given <code>workorder</code> type ids are all valid</p>

<pre>    my $Ok = $WorkOrderObject-&#62;_CheckWorkOrderTypeIDs(
        WorkOrderTypeIDs =&#62; [ 2, 500 ],
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_GetWorkOrderNumber()"
><a name='//apple_ref/cpp/Function/_GetWorkOrderNumber()' class='dashAnchor'></a>_GetWorkOrderNumber()</a></h2>

<p>Get a new unused <code>workorder</code> number for the given change. The highest current <code>workorder</code> number for the given change is looked up and incremented by one.</p>

<pre>    my $WorkOrderNumber = $WorkOrderObject-&#62;_GetWorkOrderNumber(
        ChangeID =&#62; 2,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_CheckWorkOrderParams()"
><a name='//apple_ref/cpp/Function/_CheckWorkOrderParams()' class='dashAnchor'></a>_CheckWorkOrderParams()</a></h2>

<p>Checks the params to WorkOrderAdd() and WorkOrderUpdate(). There are no required parameters. The value for <code>WorkOrderAgentID</code> can be undefined.</p>

<pre>    my $Ok = $WorkOrderObject-&#62;_CheckWorkOrderParams(
        ChangeID           =&#62; 123,                                             # (optional)
        WorkOrderNumber    =&#62; 5,                                               # (optional)
        WorkOrderTitle     =&#62; &#39;Replacement of mail server&#39;,                    # (optional)
        Instruction        =&#62; &#39;Install the &#60;b&#62;new&#60;/b&#62; server&#39;,                 # (optional)
        InstructionPlain   =&#62; &#39;Install the new server&#39;,                        # (optional)
        Report             =&#62; &#39;Installed new server &#60;b&#62;without&#60;/b&#62; problems&#39;,  # (optional)
        ReportPlain        =&#62; &#39;Installed new server without problems&#39;,         # (optional)
        WorkOrderStateID   =&#62; 4,                                               # (optional)
        WorkOrderTypeID    =&#62; 12,                                              # (optional)
        WorkOrderAgentID   =&#62; 8,                                               # (optional) undef is allowed
        PlannedStartTime   =&#62; &#39;2009-10-01 10:33:00&#39;,                           # (optional)
        ActualStartTime    =&#62; &#39;2009-10-01 10:33:00&#39;,                           # (optional)
        PlannedEndTime     =&#62; &#39;2009-10-01 10:33:00&#39;,                           # (optional)
        ActualEndTime      =&#62; &#39;2009-10-01 10:33:00&#39;,                           # (optional)
        DynamicField_X     =&#62; &#39;Sun&#39;,                                           # (optional)
        DynamicField_Y     =&#62; &#39;Earth&#39;,                                         # (optional)

    );</pre>

<p>These string parameters have length constraints:</p>

<pre>    Parameter        | max. length
    -----------------+-----------------
    WorkOrderTitle      |  250 characters
    Instruction         | 1800000 characters
    InstructionPlain    | 1800000 characters
    Report              | 1800000 characters
    ReportPlain         | 1800000 characters
    DynamicField_X      | 3800 characters
    DynamicField_Y      | 3800 characters</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_CheckTimestamps()"
><a name='//apple_ref/cpp/Function/_CheckTimestamps()' class='dashAnchor'></a>_CheckTimestamps()</a></h2>

<p>Checks the constraints of timestamps: <code>xxxStartTime</code> must be before <code>xxxEndTime</code></p>

<pre>    my $Ok = $WorkOrderObject-&#62;_CheckTimestamps(
        WorkOrderData    =&#62; $WorkOrderData,
        PlannedStartTime =&#62; &#39;2009-10-12 00:00:01&#39;,     # (optional) or undef
        PlannedEndTime   =&#62; &#39;2009-10-15 15:00:00&#39;,     # (optional) or undef
        ActualStartTime  =&#62; &#39;2009-10-14 00:00:01&#39;,     # (optional) or undef
        ActualEndTime    =&#62; &#39;2009-01-20 00:00:01&#39;,     # (optional) or undef
    );</pre>

<p>If PlannedStartTime is given, PlannedEndTime has to be given, too - and vice versa. If ActualStartTime is given ActualEndTime is optional. But if ActualEndTime is given then ActualStartTime has to be given, too. WorkOrderData is only passed for improving the performance.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TERMS_AND_CONDITIONS"
><a name='//apple_ref/cpp/Class/TERMS AND CONDITIONS' class='dashAnchor'></a>TERMS AND CONDITIONS</a></h1>

<p>This software is part of the OTRS project (<a href="https://otrs.org/" class="podlinkurl"
>https://otrs.org/</a>).</p>

<p>This software comes with ABSOLUTELY NO WARRANTY. For details, see the enclosed file COPYING for license information (GPL). If you did not receive this file, see <a href="https://www.gnu.org/licenses/gpl-3.0.txt" class="podlinkurl"
>https://www.gnu.org/licenses/gpl-3.0.txt</a>.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
