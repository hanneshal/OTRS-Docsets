<html><head><title>Kernel::System::ITSMConfigItem::Version</title>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" >
<link rel="stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="blkmagw" type="text/css" href="../../../_blkmagw.css" media="all" >
<link rel="alternate stylesheet" title="blkcynw" type="text/css" href="../../../_blkcynw.css" media="all" >
<link rel="alternate stylesheet" title="whtprpk" type="text/css" href="../../../_whtprpk.css" media="all" >
<link rel="alternate stylesheet" title="whtnavk" type="text/css" href="../../../_whtnavk.css" media="all" >
<link rel="alternate stylesheet" title="grygrnk" type="text/css" href="../../../_grygrnk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="blkgrng" type="text/css" href="../../../_blkgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >
<link rel="alternate stylesheet" title="blkbluw" type="text/css" href="../../../_blkbluw.css" media="all" >
<link rel="alternate stylesheet" title="whtpurk" type="text/css" href="../../../_whtpurk.css" media="all" >
<link rel="alternate stylesheet" title="whtgrng" type="text/css" href="../../../_whtgrng.css" media="all" >
<link rel="alternate stylesheet" title="grygrnw" type="text/css" href="../../../_grygrnw.css" media="all" >

<script type="text/javascript" src="../../../_podly.js"></script>

</head>
<body class='pod'>
<!--
  generated by Pod::Simple::HTML v3.28,
  using Pod::Simple::PullParser v3.28,
  under Perl v5.018004 at Tue Feb 16 20:51:28 2021 GMT.

 If you want to change this HTML document, you probably shouldn't do that
   by changing it directly.  Instead, see about changing the calling options
   to Pod::Simple::HTML, and/or subclassing Pod::Simple::HTML,
   then reconverting this document from the Pod source.
   When in doubt, email the author of Pod::Simple::HTML for advice.
   See 'perldoc Pod::Simple::HTML' for more info.

-->

<!-- start doc -->
<p class="backlinktop"><b><a name="___top" href="../../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>

<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#PUBLIC_INTERFACE'>PUBLIC INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#VersionZoomList()'>VersionZoomList()</a>
    <li class='indexItem indexItem2'><a href='#VersionListAll()'>VersionListAll()</a>
    <li class='indexItem indexItem2'><a href='#VersionList()'>VersionList()</a>
    <li class='indexItem indexItem2'><a href='#VersionGet()'>VersionGet()</a>
    <li class='indexItem indexItem2'><a href='#VersionNameGet()'>VersionNameGet()</a>
    <li class='indexItem indexItem2'><a href='#VersionConfigItemIDGet()'>VersionConfigItemIDGet()</a>
    <li class='indexItem indexItem2'><a href='#VersionAdd()'>VersionAdd()</a>
    <li class='indexItem indexItem2'><a href='#VersionDelete()'>VersionDelete()</a>
    <li class='indexItem indexItem2'><a href='#VersionSearch()'>VersionSearch()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#INTERNAL_INTERFACE'>INTERNAL INTERFACE</a>
  <ul   class='indexList indexList2'>
    <li class='indexItem indexItem2'><a href='#_GetEvents()'>_GetEvents()</a>
    <li class='indexItem indexItem2'><a href='#_EventHandlerForChangedXMLValues()'>_EventHandlerForChangedXMLValues()</a>
    <li class='indexItem indexItem2'><a href='#_FindChangedXMLValues()'>_FindChangedXMLValues()</a>
    <li class='indexItem indexItem2'><a href='#_GrabTagKeys()'>_GrabTagKeys()</a>
  </ul>
  <li class='indexItem indexItem1'><a href='#TERMS_AND_CONDITIONS'>TERMS AND CONDITIONS</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
><a name='//apple_ref/cpp/Class/NAME' class='dashAnchor'></a>NAME</a></h1>

<p>Kernel::System::ITSMConfigItem::Version - sub module of Kernel::System::ITSMConfigItem</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
><a name='//apple_ref/cpp/Class/DESCRIPTION' class='dashAnchor'></a>DESCRIPTION</a></h1>

<p>All version functions.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="PUBLIC_INTERFACE"
><a name='//apple_ref/cpp/Class/PUBLIC INTERFACE' class='dashAnchor'></a>PUBLIC INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionZoomList()"
><a name='//apple_ref/cpp/Function/VersionZoomList()' class='dashAnchor'></a>VersionZoomList()</a></h2>

<p>return a config item version list as array-hash reference</p>

<pre>    my $VersionListRef = $ConfigItemObject-&#62;VersionZoomList(
        ConfigItemID =&#62; 123,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionListAll()"
><a name='//apple_ref/cpp/Function/VersionListAll()' class='dashAnchor'></a>VersionListAll()</a></h2>

<p>Returns a two-dimensional hash reference with the config item ids as keys of the first level and the corresponding version ids as keys of the second level, then followed by the version data as hash reference.</p>

<pre>    my $VersionListRef = $ConfigItemObject-&#62;VersionListAll(
        ConfigItemIDs =&#62; [ 1, 2, 3, 4, ...],    # optional

        OlderDate     =&#62; &#39;2014-12-22 23:59:59&#39;, # optional
                                                # finds versions older than the given date
                                                # Format MUST be
                                                # YYYY-MM-DD HH:MM:SS
                                                # fill missing values with 0 first
                                                # Example: 2014-04-01 07:03:04
                                                # otherwise it won&#39;t be taken as
                                                # valid search parameter

        Limit         =&#62; 1000000,               # optional
    );</pre>

<p>Returns:</p>

<p>$VersionListRef = {</p>

<pre>    # ConfigItemID
    1 =&#62; {

        # VersionID
        100 =&#62; {
            VersionID    =&#62; 100,
            ConfigItemID =&#62; 1,
            Name         =&#62; &#39;ConfigItem1&#39;,
            DefinitionID =&#62; 5,
            DeplStateID  =&#62; 3,
            InciStateID  =&#62; 2,
            CreateTime   =&#62; &#39;2016-03-22 17:58:00&#39;,
            CreateBy     =&#62; 1,
        },

        # VersionID
        101 =&#62; {
            VersionID    =&#62; 101,
            ConfigItemID =&#62; 1,
            Name         =&#62; &#39;ConfigItem2&#39;,
            DefinitionID =&#62; 5,
            DeplStateID  =&#62; 3,
            InciStateID  =&#62; 2,
            CreateTime   =&#62; &#39;2016-03-22 17:58:00&#39;,
            CreateBy     =&#62; 1,
        },
    },

    # ConfigItemID
    2 =&#62; {

        # VersionID
        150 =&#62; {
            VersionID    =&#62; 150,
            ConfigItemID =&#62; 2,
            Name         =&#62; &#39;ConfigItem1&#39;,
            DefinitionID =&#62; 5,
            DeplStateID  =&#62; 3,
            InciStateID  =&#62; 2,
            CreateTime   =&#62; &#39;2016-03-22 17:58:00&#39;,
            CreateBy     =&#62; 1,
        },

        # VersionID
        151 =&#62; {
            VersionID    =&#62; 151,
            ConfigItemID =&#62; 2,
            Name         =&#62; &#39;ConfigItem1&#39;,
            DefinitionID =&#62; 5,
            DeplStateID  =&#62; 3,
            InciStateID  =&#62; 2,
            CreateTime   =&#62; &#39;2016-03-22 17:58:00&#39;,
            CreateBy     =&#62; 1,
        },
    },
};</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionList()"
><a name='//apple_ref/cpp/Function/VersionList()' class='dashAnchor'></a>VersionList()</a></h2>

<p>return a config item version list as array reference</p>

<pre>    my $VersionListRef = $ConfigItemObject-&#62;VersionList(
        ConfigItemID =&#62; 123,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionGet()"
><a name='//apple_ref/cpp/Function/VersionGet()' class='dashAnchor'></a>VersionGet()</a></h2>

<p>returns a version of a config item as hash reference. The returned hash contains following attributes.</p>

<pre>    $Version{VersionID}
    $Version{ConfigItemID}
    $Version{Number}
    $Version{ClassID}
    $Version{Class}
    $Version{LastVersionID}
    $Version{Name}
    $Version{DefinitionID}
    $Version{DeplStateID}
    $Version{DeplState}
    $Version{DeplStateType}
    $Version{CurDeplStateID}
    $Version{CurDeplState}
    $Version{CurDeplStateType}
    $Version{InciStateID}
    $Version{InciState}
    $Version{InciStateType}
    $Version{CurInciStateID}
    $Version{CurInciState}
    $Version{CurInciStateType}
    $Version{XMLDefinition}
    $Version{XMLData}
    $Version{CreateTime}
    $Version{CreateBy}

    my $VersionRef = $ConfigItemObject-&#62;VersionGet(
        VersionID  =&#62; 123,
        XMLDataGet =&#62; 1,    # (optional) default 1 (0|1)
    );

    or

    my $VersionRef = $ConfigItemObject-&#62;VersionGet(
        ConfigItemID =&#62; 123,
    );</pre>

<p>When the data from the XML storage is not needed then fetching the XML data can be explicitly turned off by passing XMLDataGet =&#62; 0.</p>

<pre>    my $VersionRef = $ConfigItemObject-&#62;VersionGet(
        ConfigItemID =&#62; 123,
        XMLDataGet   =&#62; 0,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionNameGet()"
><a name='//apple_ref/cpp/Function/VersionNameGet()' class='dashAnchor'></a>VersionNameGet()</a></h2>

<p>returns the name of a version of a config item.</p>

<pre>    my $VersionName = $ConfigItemObject-&#62;VersionNameGet(
        VersionID =&#62; 123,
    );

    or

    my $VersionName = $ConfigItemObject-&#62;VersionNameGet(
        ConfigItemID =&#62; 123,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionConfigItemIDGet()"
><a name='//apple_ref/cpp/Function/VersionConfigItemIDGet()' class='dashAnchor'></a>VersionConfigItemIDGet()</a></h2>

<p>return the config item id of a version</p>

<pre>    my $ConfigItemID = $ConfigItemObject-&#62;VersionConfigItemIDGet(
        VersionID =&#62; 123,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionAdd()"
><a name='//apple_ref/cpp/Function/VersionAdd()' class='dashAnchor'></a>VersionAdd()</a></h2>

<p>add a new version</p>

<pre>    my $VersionID = $ConfigItemObject-&#62;VersionAdd(
        ConfigItemID =&#62; 123,
        Name         =&#62; &#39;The Name&#39;,
        DefinitionID =&#62; 1212,
        DeplStateID  =&#62; 8,
        InciStateID  =&#62; 4,
        XMLData      =&#62; $ArrayHashRef,  # (optional)
        UserID       =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionDelete()"
><a name='//apple_ref/cpp/Function/VersionDelete()' class='dashAnchor'></a>VersionDelete()</a></h2>

<p>delete an existing version or versions</p>

<pre>    my $True = $ConfigItemObject-&#62;VersionDelete(
        VersionID =&#62; 123,
        UserID    =&#62; 1,
    );

    or

    my $True = $ConfigItemObject-&#62;VersionDelete(
        ConfigItemID =&#62; 321,
        UserID       =&#62; 1,
    );

    my $True = $ConfigItemObject-&#62;VersionDelete(
        VersionIDs =&#62; [ 1, 2, 3, 4 ],
        UserID     =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="VersionSearch()"
><a name='//apple_ref/cpp/Function/VersionSearch()' class='dashAnchor'></a>VersionSearch()</a></h2>

<p>return a config item list as an array reference</p>

<pre>    my $ConfigItemIDs = $ConfigItemObject-&#62;VersionSearch(
        Name         =&#62; &#39;The Name&#39;,      # (optional)
        ClassIDs     =&#62; [ 9, 8, 7, 6 ],  # (optional)
        DeplStateIDs =&#62; [ 321, 123 ],    # (optional)
        InciStateIDs =&#62; [ 321, 123 ],    # (optional)

        PreviousVersionSearch =&#62; 1,  # (optional) default 0 (0|1)

        OrderBy =&#62; [ &#39;ConfigItemID&#39;, &#39;Number&#39; ],                  # (optional)
        # default: [ &#39;ConfigItemID&#39; ]
        # (ConfigItemID, Name, Number, ClassID, DeplStateID, InciStateID
        # CreateTime, CreateBy, ChangeTime, ChangeBy)

        # Additional information for OrderBy:
        # The OrderByDirection can be specified for each OrderBy attribute.
        # The pairing is made by the array indices.

        OrderByDirection =&#62; [ &#39;Up&#39;, &#39;Down&#39; ],                    # (optional)
        # default: [ &#39;Up&#39; ]
        # (Down | Up)

        Limit          =&#62; 122,  # (optional)
        UsingWildcards =&#62; 0,    # (optional) default 1
    );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="INTERNAL_INTERFACE"
><a name='//apple_ref/cpp/Class/INTERNAL INTERFACE' class='dashAnchor'></a>INTERNAL INTERFACE</a></h1>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_GetEvents()"
><a name='//apple_ref/cpp/Function/_GetEvents()' class='dashAnchor'></a>_GetEvents()</a></h2>

<p>This method checks what values were changed and what events have to be triggered. It returns a hash reference with all event names as keys that should be triggered.</p>

<pre>    my $Events = $CIObject-&#62;_GetEvents(
        Param =&#62; {
            DeplStateID =&#62; 123,
        },
        ConfigItemInfo =&#62; {
            DeplStateID =&#62; 234,
        },
    );

    print keys %{$Events}; # prints &#34;DeploymentStateUpdate&#34;</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_EventHandlerForChangedXMLValues()"
><a name='//apple_ref/cpp/Function/_EventHandlerForChangedXMLValues()' class='dashAnchor'></a>_EventHandlerForChangedXMLValues()</a></h2>

<p>This method calls the event handler for each changed value of the config item. The changed values are passed in <code>UpdateValues</code> as an hashref with tag-keys as keys. Please note that this only handles values inside the XML structure, not general attributes like <code>CurInciState</code>.</p>

<pre>    my $Success = $ConfigItemObject-&#62;_EventHandlerForChangedXMLValues(
        ConfigItemID =&#62; 123,
        UpdateValues =&#62;
            {
               &#34;[1]{&#39;Version&#39;}[1]{&#39;Vendor&#39;}[1]&#34; =&#62; &#39;OldVendor%%NewVendor&#39;,
               &#34;[1]{&#39;Version&#39;}[1]{&#39;Type&#39;}[1]&#34;   =&#62; &#39;127%%128&#39;,
            }
        UserID       =&#62; 1,
    );</pre>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_FindChangedXMLValues()"
><a name='//apple_ref/cpp/Function/_FindChangedXMLValues()' class='dashAnchor'></a>_FindChangedXMLValues()</a></h2>

<p>compares the new xml data <code>NewXMLData</code> with the xml data of the latest version of the config item <code>ConfigItemID</code>. Note that the new XML data does not contain tag keys. All values of the two data sets are compared. When a changed value is encountered, the tag key and the old and the new value are stored in a hash. The hash with the updated values is returned.</p>

<pre>    my %UpdateValues = $ConfigItemObject-&#62;_FindChangedXMLValues(
        ConfigItemID =&#62; 123,
        NewXMLData   =&#62;
            [
                undef,
                {
                    &#39;Version&#39; =&#62;
                        [
                            undef,
                            {
                                &#39;Owner&#39; =&#62;
                                    [
                                       undef,
                                       {
                                           &#39;Content&#39; =&#62; &#39;&#39;
                                       },
                                    ],
                            },
                        ],
                },
            ],
    );</pre>

<p>The returned hash looks like:</p>

<pre>    %UpdateValues = (
       &#34;[1]{&#39;Version&#39;}[1]{&#39;Vendor&#39;}[1]&#34; =&#62; &#39;OldVendor%%NewVendor&#39;,
       &#34;[1]{&#39;Version&#39;}[1]{&#39;Type&#39;}[1]&#34;   =&#62; &#39;127%%128&#39;,
    );</pre>

<p>The key is a tag key. The values contains the old and the new XML value.</p>

<h2><a class='u' href='#___top' title='click to go to top of document'
name="_GrabTagKeys()"
><a name='//apple_ref/cpp/Function/_GrabTagKeys()' class='dashAnchor'></a>_GrabTagKeys()</a></h2>

<p>recursively scans a perl data structure for the hash key &#39;TagKey&#39; and returns a list of all the values for that key.</p>

<pre>    my @TagKeys = $ConfigItemObject-&#62;_GrabTagKeys(
        Data =&#62; $XMLHashReferenz,
    );</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="TERMS_AND_CONDITIONS"
><a name='//apple_ref/cpp/Class/TERMS AND CONDITIONS' class='dashAnchor'></a>TERMS AND CONDITIONS</a></h1>

<p>This software is part of the OTRS project (<a href="https://otrs.org/" class="podlinkurl"
>https://otrs.org/</a>).</p>

<p>This software comes with ABSOLUTELY NO WARRANTY. For details, see the enclosed file COPYING for license information (GPL). If you did not receive this file, see <a href="https://www.gnu.org/licenses/gpl-3.0.txt" class="podlinkurl"
>https://www.gnu.org/licenses/gpl-3.0.txt</a>.</p>
<p class="backlinkbottom"><b><a name="___bottom" href="../../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
